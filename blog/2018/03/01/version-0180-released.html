<!doctype html>
<html lang="zh-CN">
  <head>
  <meta name="charset" content="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Nim 语言是一种简洁、快速的编程语言， 可被编译成 C 、 C++ 甚至 JavaScript 。">
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="https://nim-lang-cn.org/assets/img/logo_bw.png" />

  
  <title>Version 0.18.0 released - Nim博客</title>
  
  <link rel="stylesheet" href="https://nim-lang-cn.org/assets/css/pure.min.css">
  <link rel="stylesheet" href="https://nim-lang-cn.org/assets/css/pure-grids-responsive.min.css">
  <!-- <link href="https://use.fontawesome.com/releases/v5.0.2/css/all.css" rel="stylesheet"> -->
  <link href="https://cdn.bootcss.com/font-awesome/5.10.2/css/all.min.css" rel="stylesheet">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  
  <link rel="stylesheet" href="https://nim-lang-cn.org/assets/css/highlight/github.css">
  

  <meta name="keyword" content="nim,nim中文,Nim中文社区,nim中文网,nim语言,nim编程语言">

  <!-- <link href="https://fonts.googleapis.com/css?family=Inconsolata|Open+Sans|Titillium+Web" rel="stylesheet"> -->
  <link href="https://fonts.font.im/css?family=Inconsolata|Open+Sans|Titillium+Web" rel="stylesheet">
  <link rel="stylesheet" href="https://nim-lang-cn.org/assets/css/main.css?t=1634689864454356343">

  <!-- <meta name="twitter:title" content="Version 0.18.0 released"> -->

  
  <!-- <meta name="twitter:description" content="The Nim team is happy to announce that the latest release of Nim, version 0.18.0, is now available. Nim is a systems programming language that focuses on performance, portability and expressiveness. Installing 0.18.0 If you have installed a previous version of Nim using choosenim, getting Nim 0.18.0 is as easy as: $ choosenim update stable If you don’t have it already, you can get choosenim by following these instructions or you can install Nim manually by following the instructions on our install page. Note that Windows users might still have an easier time with the unzip+finish.exe method of installing Nim which is described on the install page. What’s new in 0.18.0 It’s been a while since our last release, but we’ve been busy. At over 1000 commits since the last release, v0.18.0 is one of (if not the) biggest releases of Nim ever. We have mentioned multiple times that this will be a major release. Primarily because our goal has been to clean up the standard library significantly in preparation for v1.0. We’ve made massive progress in this release to achieve that goal. The downside is that this release has a much larger proportion of breaking changes than normal releases, but it is all in the spirit of a cleaner Nim v1.0. Breaking changes to be mindful of You will find that the [] indexing operator which takes a slice now raises an IndexError exception when it is out of bounds. Previously it would have simply returned the part of the string that was captured. You may find that your program hasn’t taken this into account and will now crash with an IndexError exception. To get back the previous behaviour, use the substr procedure. Here is an example of the issue and how to get around it: var myString = "hello world" doAssertRaises IndexError: discard myString[6 .. 45] doAssert myString.substr(6, 45) == "world" The $ operator now handles collections differently. For example: doAssert $(@["23", "12"]) == "@[\"23\", \"12\"]" # Whereas in 0.17.2: doAssert $(@["23", "12"]) == "@[23, 12]" An array[x, char] can no longer be converted to a cstring type. This has the side-effect of allowing $ to be defined on an array: var x: array[5, char] doAssert $x == r"['\x00', '\x00', '\x00', '\x00', '\x00']" Be sure to check out the changelog below for a comprehensive list of breaking changes. If you run into any strange regressions feel free to pop into IRC, Gitter, Discord or any of the other chat rooms/forums we have available. Links to them all are available in our community page. New features Of course, this being a major new release, there are also plenty of new features. Formatted string literals The greatest new addition is the strformat module. It implements string formatting that is very similar to Python 3’s f-strings. Formatted string literals are prefixed with fmt or the &amp; operator: import strformat let name = "Fred" let age = 24 let weight = 94.52 doAssert fmt"My name is {name}. I'm {age} years of age and weigh {weight:.3f}." == "My name is Fred. I'm 24 years of age and weigh 94.520." For more information, take a look at the strformat documentation. Testable documentation examples The documentation generator can now test your examples for you! This is done using the new runnableExamples macro. proc add*(x, y: int): int = ## Adds two numbers together. ## ## Examples: ## runnableExamples: doAssert add(5, 5) == 10 doAssert add(-5, 2) == -3 x + y If you save this as addLib.nim and then generate its documentation via nim doc addLib.nim, you should see something like this: Hint: /tmp/addLib_examples [Exec] Hint: operation successful (13129 lines compiled; 0.492 sec total; 19.742MiB peakmem; Debug Build) [SuccessX] The code under runnableExamples will be embedded in the procedure’s documentation. If your examples have an error in them then you will see it, together with a stack trace if your error occurs at runtime. This is great for ensuring that your documentation is up-to-date. mapLiterals This is a new macro that allows you to easily create array and sequence literals. import sequtils let x = mapLiterals([12, 34, 15, 1], uint32) doAssert x is array[4, uint32] New memory manager algorithm The new TLSF algorithm has been implemented to reduce memory fragmentation. This has a side effect of making alloc and dealloc O(1) operations. Async improvements There have been a number of various improvements to the asynchronous IO modules in the stdlib. There is no longer an “upcoming” and standard asyncdispatch split, the former was merged and is now the default asyncdispatch implementation. A new getIoHandler procedure is now available, it returns a handle to the underlying IO completion port or epoll/kqueue fd used by asyncdispatch. Main advantage of this is that libraries now have even greater control over the event loop. As an example, it allows much more efficient HTTP server implementations (one such implementation is called httpbeast). A new implementation of async await has also been added for the JavaScript backend in the asyncjs module. Nimble v0.8.10 In the release are also updates to the Nim package manager. The latest version of Nimble is included and contains multiple new features and bug fixes. The major new feature is the support for multiple Nimble packages in a single Git/Hg repository. Check out the changelog for a list of changes since Nimble’s last release. Contributors to v0.18.0 Our contributors are amazing, and there is far too many to list here. Big thanks to all of you, we couldn’t have pulled off this release without you! Changelog Changes affecting backwards compatibility Breaking changes in the standard library The [] proc for strings now raises an IndexError exception when the specified slice is out of bounds. See issue #6223 for more details. You can use substr(str, start, finish) to get the old behaviour back, see this commit for an example. strutils.split and strutils.rsplit with an empty string and a separator now returns that empty string. See issue #4377. Arrays of char cannot be converted to cstring anymore, pointers to arrays of char can! This means $ for arrays can finally exist in system.nim and do the right thing. This means $myArrayOfChar changed its behaviour! Compile with -d:nimNoArrayToString to see where to fix your code. reExtended is no longer default for the re constructor in the re module. The behavior of $ has been changed for all standard library collections. The collection-to-string implementations now perform proper quoting and escaping of strings and chars. newAsyncSocket taking an AsyncFD now runs setBlocking(false) on the fd. mod and bitwise and do not produce range subtypes anymore. This turned out to be more harmful than helpful and the language is simpler without this special typing rule. formatFloat/formatBiggestFloat now support formatting floats with zero precision digits. The previous precision = 0 behavior (default formatting) is now available via precision = -1. Moved from stdlib into Nimble packages: basic2d deprecated: use glm, arraymancer, neo, or another package instead basic3d deprecated: use glm, arraymancer, neo, or another package instead gentabs libuv polynumeric pdcurses romans libsvm joyent_http_parser Proc toCountTable now produces a CountTable with values corresponding to the number of occurrences of the key in the input. It used to produce a table with all values set to 1. Counting occurrences in a sequence used to be: let mySeq = @[1, 2, 1, 3, 1, 4] var myCounter = initCountTable[int]() for item in mySeq: myCounter.inc item Now, you can simply do: let mySeq = @[1, 2, 1, 3, 1, 4] myCounter = mySeq.toCountTable() If you use --dynlibOverride:ssl with OpenSSL 1.0.x, you now have to define openssl10 symbol (-d:openssl10). By default OpenSSL 1.1.x is assumed. newNativeSocket is now named createNativeSocket. newAsyncNativeSocket is now named createAsyncNativeSocket and it no longer raises an OS error but returns an osInvalidSocket when creation fails. The securehash module is now deprecated. Instead import std / sha1. The readPasswordFromStdin proc has been moved from the rdstdin to the terminal module, thus it does not depend on linenoise anymore. Breaking changes in the compiler \n is now only the single line feed character like in most other programming languages. The new platform specific newline escape sequence is written as \p. This change only affects the Windows platform. The overloading rules changed slightly so that constrained generics are preferred over unconstrained generics. (Bug #6526) We changed how array accesses “from backwards” like a[^1] or a[0..^1] are implemented. These are now implemented purely in system.nim without compiler support. There is a new “heterogeneous” slice type system.HSlice that takes 2 generic parameters which can be BackwardsIndex indices. BackwardsIndex is produced by system.^. This means if you overload [] or []= you need to ensure they also work with system.BackwardsIndex (if applicable for the accessors). The parsing rules of if expressions were changed so that multiple statements are allowed in the branches. We found few code examples that now fail because of this change, but here is one: t[ti] = if exp_negative: '-' else: '+'; inc(ti) This now needs to be written as: t[ti] = (if exp_negative: '-' else: '+'); inc(ti) The experimental overloading of the dot . operators now take an untyped parameter as the field name, it used to be a static[string]. You can use when defined(nimNewDot) to make your code work with both old and new Nim versions. See special-operators for more information. yield (or await which is mapped to yield) never worked reliably in an array, seq or object constructor and is now prevented at compile-time. Library additions Added sequtils.mapLiterals for easier construction of array and tuple literals. Added system.runnableExamples to make examples in Nim’s documentation easier to write and test. The examples are tested as the last step of nim doc. Implemented getIoHandler proc in the asyncdispatch module that allows you to retrieve the underlying IO Completion Port or Selector[AsyncData] object in the specified dispatcher. For string formatting / interpolation a new module called strformat has been added to the stdlib. The ReadyKey type in the selectors module now contains an errorCode field to help distinguish between Event.Error events. Implemented an accept proc that works on a SocketHandle in nativesockets. Added algorithm.rotateLeft. Added typetraits.$ as an alias for typetraits.name. Added system.getStackTraceEntries that allows you to access the stack trace in a structured manner without string parsing. Added parseutils.parseSaturatedNatural. Added macros.unpackVarargs. Added support for asynchronous programming for the JavaScript backend using the asyncjs module. Added true color support for some terminals. Example: import colors, terminal const Nim = "Efficient and expressive programming." var fg = colYellow bg = colBlue int = 1.0 enableTrueColors() for i in 1..15: styledEcho bgColor, bg, fgColor, fg, Nim, resetStyle int -= 0.01 fg = intensity(fg, int) setForegroundColor colRed setBackgroundColor colGreen styledEcho "Red on Green.", resetStyle Library changes echo now works with strings that contain \0 (the binary zero is not shown) and nil strings are equal to empty strings. JSON: Deprecated getBVal, getFNum, and getNum in favour of getBool, getFloat, getBiggestInt. A new getInt procedure was also added. rationals.toRational now uses an algorithm based on continued fractions. This means its results are more precise and it can’t run into an infinite loop anymore. os.getEnv now takes an optional default parameter that tells getEnv what to return if the environment variable does not exist. The random procs in random.nim have all been deprecated. Instead use the new rand procs. The module now exports the state of the random number generator as type Rand so multiple threads can easily use their own random number generators that do not require locking. For more information about this rename see issue #6934 writeStackTrace is now proclaimed to have no IO effect (even though it does) so that it is more useful for debugging purposes. db_mysql module: DbConn is now a distinct type that doesn’t expose the details of the underlying PMySQL type. parseopt2 is now deprecated, use parseopt instead. Language additions It is now possible to forward declare object types so that mutually recursive types can be created across module boundaries. See package level objects for more information. Added support for casting between integers of same bitsize in VM (compile time and nimscript). This allows to, among other things, reinterpret signed integers as unsigned. Custom pragmas are now supported using pragma pragma, please see language manual for details. Standard library modules can now also be imported via the std pseudo-directory. This is useful in order to distinguish between standard library and nimble package imports: import std / [strutils, os, osproc] import someNimblePackage / [strutils, os] Language changes The unary &lt; is now deprecated, for .. &lt; use ..&lt; for other usages use the pred proc. Bodies of for loops now get their own scope: # now compiles: for i in 0..4: let i = i + 1 echo i To make Nim even more robust the system iterators .. and countup now only accept a single generic type T. This means the following code doesn’t die with an “out of range” error anymore: var b = 5.Natural var a = -5 for i in a..b: echo i atomic and generic are no longer keywords in Nim. generic used to be an alias for concept, atomic was not used for anything. The memory manager now uses a variant of the TLSF algorithm that has much better memory fragmentation behaviour. According to http://www.gii.upv.es/tlsf/ the maximum fragmentation measured is lower than 25%. As a nice bonus alloc and dealloc became O(1) operations. The compiler is now more consistent in its treatment of ambiguous symbols: Types that shadow procs and vice versa are marked as ambiguous (bug #6693). codegenDecl pragma now works for the JavaScript backend. It returns an empty string for function return type placeholders. Extra semantic checks for procs with noreturn pragma: return type is not allowed, statements after call to noreturn procs are no longer allowed. Noreturn proc calls and raising exceptions branches are now skipped during common type deduction in if and case expressions. The following code snippets now compile: import strutils let str = "Y" let a = case str: of "Y": true of "N": false else: raise newException(ValueError, "Invalid boolean") let b = case str: of nil, "": raise newException(ValueError, "Invalid boolean") elif str.startsWith("Y"): true elif str.startsWith("N"): false else: false let c = if str == "Y": true elif str == "N": false else: echo "invalid bool" quit("this is the end") Pragmas now support call syntax, for example: {.exportc"myname".} and {.exportc("myname").} The deprecated pragma now supports a user-definable warning message for procs. proc bar {.deprecated: "use foo instead".} = return bar() Tool changes The nim doc command is now an alias for nim doc2, the second version of the documentation generator. The old version 1 can still be accessed via the new nim doc0 command. Nim’s rst2html command now supports the testing of code snippets via an RST extension that we called :test::: .. code-block:: nim :test: # shows how the 'if' statement works if true: echo "yes" Bugfixes Fixed “ReraiseError when using try/except within finally block” (#5871) Fixed “Range type inference leads to counter-intuitive behvaiour” (#5854) Fixed “JSON % operator can fail in extern procs with dynamic types” (#6385) Fixed ““intVal is not accessible” in VM” (#6083) Fixed “Add excl for OrderedSet” (#2467) Fixed “newSeqOfCap actually doesn’t reserve memory” (#6403) Fixed “[Regression] Nim segfaults” (#6435) Fixed “Seq assignment is slower than expected” (#6433) Fixed “json module issues with empty dicts and lists” (#6438) Fixed “mingw installed via finish.exe fails to link if Nim located in path with whitespace” (#6452) Fixed “unittest.check does not perform short-circuit evaluation” (#5784) Fixed “Error while concatenating an array of chars.” (#5861) Fixed “range initialization: [ProveInit] hint: Cannot prove that” (#6474) Fixed “scanf can call procs with side-effects multiple times” (#6487) Fixed “gcsafe detection problem” (#5620) Fixed “C++ codegen: mitems generates invalid code.” (#4910) Fixed “strange runtime behavior on macOS” (#6496) Fixed “stdtmpl: invalid indentation after a line ending in question mark” (#5070) Fixed “Windows: NAN troubles on c backend” (#6511) Fixed “lib/nim/system/cellsets.nim(33, 31) Error: type mismatch while attempting to compile for 16bit CPUs” (#3558) Fixed “Can’t compile dynlib with -d:useNimRtl and --threads:on” (#5143) Fixed “var s = @[0,1,2,…] can generate thousand of single assignments in C code” (#5007) Fixed “echo discards everything after a null character” (#1137) Fixed “Turn off reExtended by default” (#5627) Fixed “Bad Links in docs/backends.html” (#5914) Fixed “Index out of bounds error in db_postgres when executing non parameter-substituted queries containing “?”” (#6571) Fixed “Please add pipe2 support to posix stdlib” (#6553) Fixed “Return semantics vary depending on return style” (#6422) Fixed “parsecsv.open reports SIGSEGV when calling ‘open’ on missing file” (#6148) Fixed “VCC: Nim generates non-compilable code for system.nim” (#6606) Fixed “Generic subtype matches worse than a generic” (#6526) Fixed “formatFloat inconsistent scientific notation” (#6589) Fixed “Generated c code calls function twice” (#6292) Fixed “Range type inference leads to counter-intuitive behvaiour” (#5854) Fixed “New backward indexing is too limited” (#6631) Fixed “Table usage in a macro (SIGSEGV: Illegal storage access.)” (#1860) Fixed “Incorrect deprecation error” (#6634) Fixed “Wrong indices in arrays not starting with 0” (#6675) Fixed “if expressions” (#6609) Fixed “BackwardsIndex: converter + [] + unrelated type[^1]: lib/system.nim(3536, 3) Error” (#6692) Fixed “js backend 0.17.3: array bounds check for non zero based arrays is buggy” (#6532) Fixed “HttpClient’s new API doesn’t work through a proxy for https URLs” (#6685) Fixed “isServing isn’t declared and isn’t compiling” (#6707) Fixed “[Regression] value out of range” (#6710) Fixed “Error when using multisync macro” (#6708) Fixed “formatFloat inconsistent scientific notation” (#6589) Fixed “Using : (constructor arguments) for passing values to functions with default arguments causes a compiler crash.” (#6765) Fixed “In-place object initialization leads to vcc incompatible code” (#6757) Fixed “Improve parseCookies doc” (#5721) Fixed “Parser regression with nested do notation inside conditional” (#6166) Fixed “Request for better error message” (#6776) Fixed “Testament tester does not execute test with exitcode only” (#6775) Fixed “JS integer division off by one” (#6753) Fixed “Regression: cannot prove not nil” (#5781) Fixed “SIGSEGV: Illegal storage access. (Attempt to read from nil?) in generic proc” (#6073) Fixed “Request for better error message” (#6776) Fixed “Nim #head: sorting via reference hangs compiler” (#6724) Fixed “Cannot cast pointer to char in cpp” (#5979) Fixed “asynchttpserver replies with several errors on single request” (#6386) Fixed “object variants superclass trigger bad codegen” (#5521) Fixed “JS integer division off by one” (#6753) Fixed “js backend compiler crash with tables indexed by certain types” (#6568) Fixed “Jsgen bug with is” (#6445) Fixed “Subrange definition with ..&lt;” (#6788) Fixed “fields not initialized: array with enum index type as object field.” (#6682) Fixed “Can not delete data in table when table’s data type is kind of “not nil”” (#6555) Fixed “tables.nim: Cannot prove that ‘n’ is initialized” (#6121) Fixed “issues with ‘not nil’ applied to a closure proc” (#6489) Fixed “not nil not working in some cases” (#4686) Fixed “Cannot prove ‘@[v]’ is not nil” (#3993) Fixed “Feature: support TCP_NODELAY in net.sockets” (#6795) Fixed “Code that makes the compiler throw an error message and then hangs” (#6820) Fixed “Code that makes the compiler throw an error message and then hangs” (#6820) Fixed “Inconsistent behavior with sequence and string slicing” (#6223) Fixed “Wrong behavior of “split” (proc and iterator)” (#4377) Fixed “[Documentation] Invalid module name: [foo, bar]” (#6831) Fixed “The destructor is not called for temporary objects” (#4214) Fixed “Destructors does not work with implicit items iterator in for loop” (#985) Fixed “Error in template when using the type of the parameter inside it” (#6756) Fixed “should json.to() respect parent attributes?” (#5856) Fixed “json ‘to’ macro can not marshalize into tuples” (#6095) Fixed “json.to fails with seq[T]” (#6604) Fixed “json.to() is not worth using compared to marshal.to[T]” (#5848) Fixed “Memory not being released in time, running out of memory” (#6031) Fixed “[Regression] Bad C codegen for generic code” (#6889) Fixed “rollingFileLogger deletes file on every start.” (#6264) Fixed “Remove/deprecate securehash module.” (#6033) Fixed “[bug or not] object construction for seq[T] failed without space after colon” (#5999) Fixed “issues with the random module” (#4726) Fixed “Reassigning local var to seq of objects results in nil element in Object’s seq field” (#668) Fixed “Compilation error with “newseq[string]”” (#6726) Fixed “await inside array/dict literal produces invalid code - Part 2” (#6626) Fixed “terminal.eraseline() gives OverflowError on Windows” (#6931) Fixed “[Regression] sequtils.any conflicts with system.any” (#6932) Fixed “C++ codegen: mitems generates invalid code.” (#4910) Fixed “seq.mitems produces invalid cpp codegen” (#6892) Fixed “Concepts regression” (#6108) Fixed “Generic iterable concept with array crashes compiler” (#6277) Fixed “C code generation “‘a’ is a pointer; did you mean to use ‘-&gt;’?”” (#6462) Fixed “--NimblePath fails if a - in path which is not followed by a number” (#6949) Fixed ““not registered in the selector” in asyncfile.close() for something that clearly was registered” (#6906) Fixed “strange frexp behavior” (#6353) Fixed “noreturn branches of case statements shouldn’t contribute to type” (#6885) Fixed “Type inference for ‘if’ statements changed” (#6980) Fixed “newest asyncdispatch recursion” (#6100) Fixed “Ambiguous identifier between set type and proc” (#6965) Fixed “Inconsistent behavior with sequence and string slicing” (#6223) Fixed “Unsupported OpenSSL library imported dynamically” (#5000) Fixed “nim check segfaults” (#6972) Fixed “GC deadlock” (#6988) Fixed “Create a seq without memory initialization” (#6401) Fixed “Fix bug for getch on Windows while using the arrow keys” (#6966) Fixed “runnableExamples doesn’t work in templates” (#7018) Fixed “runnableExamples doesn’t work with untyped statement blocks” (#7019) Fixed “Critical bug in parseBiggestFloat” (#7060) Fixed “[RFC] strformat.% should be gone” (#7078) Fixed “compiler crash on simple macro” (#7093) Fixed “Make newlines sane again” (#7089) Fixed “JS - Unicode enum string representation issue” (#6741) Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)” (#6989) Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)” (#6989) Fixed “Compiler crash: try expression with infix as” (#7116) Fixed “nimsuggest crash” (#7140) Fixed “[RFC] Reintroduce readChar” (#7072) Fixed “Copyright line needs updating” (#7129) Fixed “-0.0 doesn’t result in negative zero in VM” (#7079) Fixed “Windows large filesize” (#7121) Fixed “Securehash is not parsimonious with MD5 and other hash modules” (#6961) Fixed “os.findExe() shouldn’t look in current directory on posix, unless exe has a /” (#6939) Fixed “compiles(...) with fatal pragma causes compiler to exit early” (#7080) Fixed “NPE when compile macro that returns concrete value” (#5450) Fixed “Using a variable of type int | float causes internal compiler error” (#6946) Fixed “Unsigned integers could not be used as array indexes.” (#7153) Fixed “countdown with uint causes underflow” (#4220) Fixed “Inconsistent method call syntax” (#7200) Fixed “Impossible to create an empty const array” (#6853) Fixed “Strange UINT handling” (#3985) Fixed “Bad codegen when passing arg that is part of return value destination” (#6960) Fixed “No info about gcsafety in error message when global var is accessed in async proc” (#6186) Fixed “Resolving package vs. local import ambiguities” (#2819) Fixed “Internal error with type() operator” (#3711) Fixed “newAsyncSocket should raise an OS error plus other inconsistencies” (#4995) Fixed “mapLiterals fails with negative values” (#7215) Fixed “fmWrite doesn’t truncate file with openAsync, unlike open()” (#5531) Fixed “Move libsvm to an external nimble module” (#5786) Fixed “Prevent acceptAddr gotcha with newSocket” (#7227) Fixed “strtabs.getOrDefault is inconsistent with tables.getOrDefault” (#4265) Fixed “Code falling through into exception handler when no exception thrown.” (#7232) Fixed “the new generic inference rules are broken” (#7247) Fixed “Odd ..&lt; regression” (#6992) Fixed “Different proc type inferred from default parameter” (#4659) Fixed “Different proc type inferred from default parameter” (#4659) Fixed “Testament sometimes ignores test failures” (#7236) Fixed “New Allocator Fails On &gt;=4GB Requests” (#7120) Fixed “User pragmas hide effect specifications from sempass2” (#7216) Fixed “C++: SIGABRT instead of IndexError for out-of-bounds” (#6512) Fixed “An uncaught exception in cpp mode doesn’t show the exception name/msg” (#6431)"> -->
  <meta property="og:description" content="The Nim team is happy to announce that the latest release of Nim, version 0.18.0, is now available. Nim is a systems programming language that focuses on performance, portability and expressiveness. Installing 0.18.0 If you have installed a previous version of Nim using choosenim, getting Nim 0.18.0 is as easy as: $ choosenim update stable If you don’t have it already, you can get choosenim by following these instructions or you can install Nim manually by following the instructions on our install page. Note that Windows users might still have an easier time with the unzip+finish.exe method of installing Nim which is described on the install page. What’s new in 0.18.0 It’s been a while since our last release, but we’ve been busy. At over 1000 commits since the last release, v0.18.0 is one of (if not the) biggest releases of Nim ever. We have mentioned multiple times that this will be a major release. Primarily because our goal has been to clean up the standard library significantly in preparation for v1.0. We’ve made massive progress in this release to achieve that goal. The downside is that this release has a much larger proportion of breaking changes than normal releases, but it is all in the spirit of a cleaner Nim v1.0. Breaking changes to be mindful of You will find that the [] indexing operator which takes a slice now raises an IndexError exception when it is out of bounds. Previously it would have simply returned the part of the string that was captured. You may find that your program hasn’t taken this into account and will now crash with an IndexError exception. To get back the previous behaviour, use the substr procedure. Here is an example of the issue and how to get around it: var myString = "hello world" doAssertRaises IndexError: discard myString[6 .. 45] doAssert myString.substr(6, 45) == "world" The $ operator now handles collections differently. For example: doAssert $(@["23", "12"]) == "@[\"23\", \"12\"]" # Whereas in 0.17.2: doAssert $(@["23", "12"]) == "@[23, 12]" An array[x, char] can no longer be converted to a cstring type. This has the side-effect of allowing $ to be defined on an array: var x: array[5, char] doAssert $x == r"['\x00', '\x00', '\x00', '\x00', '\x00']" Be sure to check out the changelog below for a comprehensive list of breaking changes. If you run into any strange regressions feel free to pop into IRC, Gitter, Discord or any of the other chat rooms/forums we have available. Links to them all are available in our community page. New features Of course, this being a major new release, there are also plenty of new features. Formatted string literals The greatest new addition is the strformat module. It implements string formatting that is very similar to Python 3’s f-strings. Formatted string literals are prefixed with fmt or the &amp; operator: import strformat let name = "Fred" let age = 24 let weight = 94.52 doAssert fmt"My name is {name}. I'm {age} years of age and weigh {weight:.3f}." == "My name is Fred. I'm 24 years of age and weigh 94.520." For more information, take a look at the strformat documentation. Testable documentation examples The documentation generator can now test your examples for you! This is done using the new runnableExamples macro. proc add*(x, y: int): int = ## Adds two numbers together. ## ## Examples: ## runnableExamples: doAssert add(5, 5) == 10 doAssert add(-5, 2) == -3 x + y If you save this as addLib.nim and then generate its documentation via nim doc addLib.nim, you should see something like this: Hint: /tmp/addLib_examples [Exec] Hint: operation successful (13129 lines compiled; 0.492 sec total; 19.742MiB peakmem; Debug Build) [SuccessX] The code under runnableExamples will be embedded in the procedure’s documentation. If your examples have an error in them then you will see it, together with a stack trace if your error occurs at runtime. This is great for ensuring that your documentation is up-to-date. mapLiterals This is a new macro that allows you to easily create array and sequence literals. import sequtils let x = mapLiterals([12, 34, 15, 1], uint32) doAssert x is array[4, uint32] New memory manager algorithm The new TLSF algorithm has been implemented to reduce memory fragmentation. This has a side effect of making alloc and dealloc O(1) operations. Async improvements There have been a number of various improvements to the asynchronous IO modules in the stdlib. There is no longer an “upcoming” and standard asyncdispatch split, the former was merged and is now the default asyncdispatch implementation. A new getIoHandler procedure is now available, it returns a handle to the underlying IO completion port or epoll/kqueue fd used by asyncdispatch. Main advantage of this is that libraries now have even greater control over the event loop. As an example, it allows much more efficient HTTP server implementations (one such implementation is called httpbeast). A new implementation of async await has also been added for the JavaScript backend in the asyncjs module. Nimble v0.8.10 In the release are also updates to the Nim package manager. The latest version of Nimble is included and contains multiple new features and bug fixes. The major new feature is the support for multiple Nimble packages in a single Git/Hg repository. Check out the changelog for a list of changes since Nimble’s last release. Contributors to v0.18.0 Our contributors are amazing, and there is far too many to list here. Big thanks to all of you, we couldn’t have pulled off this release without you! Changelog Changes affecting backwards compatibility Breaking changes in the standard library The [] proc for strings now raises an IndexError exception when the specified slice is out of bounds. See issue #6223 for more details. You can use substr(str, start, finish) to get the old behaviour back, see this commit for an example. strutils.split and strutils.rsplit with an empty string and a separator now returns that empty string. See issue #4377. Arrays of char cannot be converted to cstring anymore, pointers to arrays of char can! This means $ for arrays can finally exist in system.nim and do the right thing. This means $myArrayOfChar changed its behaviour! Compile with -d:nimNoArrayToString to see where to fix your code. reExtended is no longer default for the re constructor in the re module. The behavior of $ has been changed for all standard library collections. The collection-to-string implementations now perform proper quoting and escaping of strings and chars. newAsyncSocket taking an AsyncFD now runs setBlocking(false) on the fd. mod and bitwise and do not produce range subtypes anymore. This turned out to be more harmful than helpful and the language is simpler without this special typing rule. formatFloat/formatBiggestFloat now support formatting floats with zero precision digits. The previous precision = 0 behavior (default formatting) is now available via precision = -1. Moved from stdlib into Nimble packages: basic2d deprecated: use glm, arraymancer, neo, or another package instead basic3d deprecated: use glm, arraymancer, neo, or another package instead gentabs libuv polynumeric pdcurses romans libsvm joyent_http_parser Proc toCountTable now produces a CountTable with values corresponding to the number of occurrences of the key in the input. It used to produce a table with all values set to 1. Counting occurrences in a sequence used to be: let mySeq = @[1, 2, 1, 3, 1, 4] var myCounter = initCountTable[int]() for item in mySeq: myCounter.inc item Now, you can simply do: let mySeq = @[1, 2, 1, 3, 1, 4] myCounter = mySeq.toCountTable() If you use --dynlibOverride:ssl with OpenSSL 1.0.x, you now have to define openssl10 symbol (-d:openssl10). By default OpenSSL 1.1.x is assumed. newNativeSocket is now named createNativeSocket. newAsyncNativeSocket is now named createAsyncNativeSocket and it no longer raises an OS error but returns an osInvalidSocket when creation fails. The securehash module is now deprecated. Instead import std / sha1. The readPasswordFromStdin proc has been moved from the rdstdin to the terminal module, thus it does not depend on linenoise anymore. Breaking changes in the compiler \n is now only the single line feed character like in most other programming languages. The new platform specific newline escape sequence is written as \p. This change only affects the Windows platform. The overloading rules changed slightly so that constrained generics are preferred over unconstrained generics. (Bug #6526) We changed how array accesses “from backwards” like a[^1] or a[0..^1] are implemented. These are now implemented purely in system.nim without compiler support. There is a new “heterogeneous” slice type system.HSlice that takes 2 generic parameters which can be BackwardsIndex indices. BackwardsIndex is produced by system.^. This means if you overload [] or []= you need to ensure they also work with system.BackwardsIndex (if applicable for the accessors). The parsing rules of if expressions were changed so that multiple statements are allowed in the branches. We found few code examples that now fail because of this change, but here is one: t[ti] = if exp_negative: '-' else: '+'; inc(ti) This now needs to be written as: t[ti] = (if exp_negative: '-' else: '+'); inc(ti) The experimental overloading of the dot . operators now take an untyped parameter as the field name, it used to be a static[string]. You can use when defined(nimNewDot) to make your code work with both old and new Nim versions. See special-operators for more information. yield (or await which is mapped to yield) never worked reliably in an array, seq or object constructor and is now prevented at compile-time. Library additions Added sequtils.mapLiterals for easier construction of array and tuple literals. Added system.runnableExamples to make examples in Nim’s documentation easier to write and test. The examples are tested as the last step of nim doc. Implemented getIoHandler proc in the asyncdispatch module that allows you to retrieve the underlying IO Completion Port or Selector[AsyncData] object in the specified dispatcher. For string formatting / interpolation a new module called strformat has been added to the stdlib. The ReadyKey type in the selectors module now contains an errorCode field to help distinguish between Event.Error events. Implemented an accept proc that works on a SocketHandle in nativesockets. Added algorithm.rotateLeft. Added typetraits.$ as an alias for typetraits.name. Added system.getStackTraceEntries that allows you to access the stack trace in a structured manner without string parsing. Added parseutils.parseSaturatedNatural. Added macros.unpackVarargs. Added support for asynchronous programming for the JavaScript backend using the asyncjs module. Added true color support for some terminals. Example: import colors, terminal const Nim = "Efficient and expressive programming." var fg = colYellow bg = colBlue int = 1.0 enableTrueColors() for i in 1..15: styledEcho bgColor, bg, fgColor, fg, Nim, resetStyle int -= 0.01 fg = intensity(fg, int) setForegroundColor colRed setBackgroundColor colGreen styledEcho "Red on Green.", resetStyle Library changes echo now works with strings that contain \0 (the binary zero is not shown) and nil strings are equal to empty strings. JSON: Deprecated getBVal, getFNum, and getNum in favour of getBool, getFloat, getBiggestInt. A new getInt procedure was also added. rationals.toRational now uses an algorithm based on continued fractions. This means its results are more precise and it can’t run into an infinite loop anymore. os.getEnv now takes an optional default parameter that tells getEnv what to return if the environment variable does not exist. The random procs in random.nim have all been deprecated. Instead use the new rand procs. The module now exports the state of the random number generator as type Rand so multiple threads can easily use their own random number generators that do not require locking. For more information about this rename see issue #6934 writeStackTrace is now proclaimed to have no IO effect (even though it does) so that it is more useful for debugging purposes. db_mysql module: DbConn is now a distinct type that doesn’t expose the details of the underlying PMySQL type. parseopt2 is now deprecated, use parseopt instead. Language additions It is now possible to forward declare object types so that mutually recursive types can be created across module boundaries. See package level objects for more information. Added support for casting between integers of same bitsize in VM (compile time and nimscript). This allows to, among other things, reinterpret signed integers as unsigned. Custom pragmas are now supported using pragma pragma, please see language manual for details. Standard library modules can now also be imported via the std pseudo-directory. This is useful in order to distinguish between standard library and nimble package imports: import std / [strutils, os, osproc] import someNimblePackage / [strutils, os] Language changes The unary &lt; is now deprecated, for .. &lt; use ..&lt; for other usages use the pred proc. Bodies of for loops now get their own scope: # now compiles: for i in 0..4: let i = i + 1 echo i To make Nim even more robust the system iterators .. and countup now only accept a single generic type T. This means the following code doesn’t die with an “out of range” error anymore: var b = 5.Natural var a = -5 for i in a..b: echo i atomic and generic are no longer keywords in Nim. generic used to be an alias for concept, atomic was not used for anything. The memory manager now uses a variant of the TLSF algorithm that has much better memory fragmentation behaviour. According to http://www.gii.upv.es/tlsf/ the maximum fragmentation measured is lower than 25%. As a nice bonus alloc and dealloc became O(1) operations. The compiler is now more consistent in its treatment of ambiguous symbols: Types that shadow procs and vice versa are marked as ambiguous (bug #6693). codegenDecl pragma now works for the JavaScript backend. It returns an empty string for function return type placeholders. Extra semantic checks for procs with noreturn pragma: return type is not allowed, statements after call to noreturn procs are no longer allowed. Noreturn proc calls and raising exceptions branches are now skipped during common type deduction in if and case expressions. The following code snippets now compile: import strutils let str = "Y" let a = case str: of "Y": true of "N": false else: raise newException(ValueError, "Invalid boolean") let b = case str: of nil, "": raise newException(ValueError, "Invalid boolean") elif str.startsWith("Y"): true elif str.startsWith("N"): false else: false let c = if str == "Y": true elif str == "N": false else: echo "invalid bool" quit("this is the end") Pragmas now support call syntax, for example: {.exportc"myname".} and {.exportc("myname").} The deprecated pragma now supports a user-definable warning message for procs. proc bar {.deprecated: "use foo instead".} = return bar() Tool changes The nim doc command is now an alias for nim doc2, the second version of the documentation generator. The old version 1 can still be accessed via the new nim doc0 command. Nim’s rst2html command now supports the testing of code snippets via an RST extension that we called :test::: .. code-block:: nim :test: # shows how the 'if' statement works if true: echo "yes" Bugfixes Fixed “ReraiseError when using try/except within finally block” (#5871) Fixed “Range type inference leads to counter-intuitive behvaiour” (#5854) Fixed “JSON % operator can fail in extern procs with dynamic types” (#6385) Fixed ““intVal is not accessible” in VM” (#6083) Fixed “Add excl for OrderedSet” (#2467) Fixed “newSeqOfCap actually doesn’t reserve memory” (#6403) Fixed “[Regression] Nim segfaults” (#6435) Fixed “Seq assignment is slower than expected” (#6433) Fixed “json module issues with empty dicts and lists” (#6438) Fixed “mingw installed via finish.exe fails to link if Nim located in path with whitespace” (#6452) Fixed “unittest.check does not perform short-circuit evaluation” (#5784) Fixed “Error while concatenating an array of chars.” (#5861) Fixed “range initialization: [ProveInit] hint: Cannot prove that” (#6474) Fixed “scanf can call procs with side-effects multiple times” (#6487) Fixed “gcsafe detection problem” (#5620) Fixed “C++ codegen: mitems generates invalid code.” (#4910) Fixed “strange runtime behavior on macOS” (#6496) Fixed “stdtmpl: invalid indentation after a line ending in question mark” (#5070) Fixed “Windows: NAN troubles on c backend” (#6511) Fixed “lib/nim/system/cellsets.nim(33, 31) Error: type mismatch while attempting to compile for 16bit CPUs” (#3558) Fixed “Can’t compile dynlib with -d:useNimRtl and --threads:on” (#5143) Fixed “var s = @[0,1,2,…] can generate thousand of single assignments in C code” (#5007) Fixed “echo discards everything after a null character” (#1137) Fixed “Turn off reExtended by default” (#5627) Fixed “Bad Links in docs/backends.html” (#5914) Fixed “Index out of bounds error in db_postgres when executing non parameter-substituted queries containing “?”” (#6571) Fixed “Please add pipe2 support to posix stdlib” (#6553) Fixed “Return semantics vary depending on return style” (#6422) Fixed “parsecsv.open reports SIGSEGV when calling ‘open’ on missing file” (#6148) Fixed “VCC: Nim generates non-compilable code for system.nim” (#6606) Fixed “Generic subtype matches worse than a generic” (#6526) Fixed “formatFloat inconsistent scientific notation” (#6589) Fixed “Generated c code calls function twice” (#6292) Fixed “Range type inference leads to counter-intuitive behvaiour” (#5854) Fixed “New backward indexing is too limited” (#6631) Fixed “Table usage in a macro (SIGSEGV: Illegal storage access.)” (#1860) Fixed “Incorrect deprecation error” (#6634) Fixed “Wrong indices in arrays not starting with 0” (#6675) Fixed “if expressions” (#6609) Fixed “BackwardsIndex: converter + [] + unrelated type[^1]: lib/system.nim(3536, 3) Error” (#6692) Fixed “js backend 0.17.3: array bounds check for non zero based arrays is buggy” (#6532) Fixed “HttpClient’s new API doesn’t work through a proxy for https URLs” (#6685) Fixed “isServing isn’t declared and isn’t compiling” (#6707) Fixed “[Regression] value out of range” (#6710) Fixed “Error when using multisync macro” (#6708) Fixed “formatFloat inconsistent scientific notation” (#6589) Fixed “Using : (constructor arguments) for passing values to functions with default arguments causes a compiler crash.” (#6765) Fixed “In-place object initialization leads to vcc incompatible code” (#6757) Fixed “Improve parseCookies doc” (#5721) Fixed “Parser regression with nested do notation inside conditional” (#6166) Fixed “Request for better error message” (#6776) Fixed “Testament tester does not execute test with exitcode only” (#6775) Fixed “JS integer division off by one” (#6753) Fixed “Regression: cannot prove not nil” (#5781) Fixed “SIGSEGV: Illegal storage access. (Attempt to read from nil?) in generic proc” (#6073) Fixed “Request for better error message” (#6776) Fixed “Nim #head: sorting via reference hangs compiler” (#6724) Fixed “Cannot cast pointer to char in cpp” (#5979) Fixed “asynchttpserver replies with several errors on single request” (#6386) Fixed “object variants superclass trigger bad codegen” (#5521) Fixed “JS integer division off by one” (#6753) Fixed “js backend compiler crash with tables indexed by certain types” (#6568) Fixed “Jsgen bug with is” (#6445) Fixed “Subrange definition with ..&lt;” (#6788) Fixed “fields not initialized: array with enum index type as object field.” (#6682) Fixed “Can not delete data in table when table’s data type is kind of “not nil”” (#6555) Fixed “tables.nim: Cannot prove that ‘n’ is initialized” (#6121) Fixed “issues with ‘not nil’ applied to a closure proc” (#6489) Fixed “not nil not working in some cases” (#4686) Fixed “Cannot prove ‘@[v]’ is not nil” (#3993) Fixed “Feature: support TCP_NODELAY in net.sockets” (#6795) Fixed “Code that makes the compiler throw an error message and then hangs” (#6820) Fixed “Code that makes the compiler throw an error message and then hangs” (#6820) Fixed “Inconsistent behavior with sequence and string slicing” (#6223) Fixed “Wrong behavior of “split” (proc and iterator)” (#4377) Fixed “[Documentation] Invalid module name: [foo, bar]” (#6831) Fixed “The destructor is not called for temporary objects” (#4214) Fixed “Destructors does not work with implicit items iterator in for loop” (#985) Fixed “Error in template when using the type of the parameter inside it” (#6756) Fixed “should json.to() respect parent attributes?” (#5856) Fixed “json ‘to’ macro can not marshalize into tuples” (#6095) Fixed “json.to fails with seq[T]” (#6604) Fixed “json.to() is not worth using compared to marshal.to[T]” (#5848) Fixed “Memory not being released in time, running out of memory” (#6031) Fixed “[Regression] Bad C codegen for generic code” (#6889) Fixed “rollingFileLogger deletes file on every start.” (#6264) Fixed “Remove/deprecate securehash module.” (#6033) Fixed “[bug or not] object construction for seq[T] failed without space after colon” (#5999) Fixed “issues with the random module” (#4726) Fixed “Reassigning local var to seq of objects results in nil element in Object’s seq field” (#668) Fixed “Compilation error with “newseq[string]”” (#6726) Fixed “await inside array/dict literal produces invalid code - Part 2” (#6626) Fixed “terminal.eraseline() gives OverflowError on Windows” (#6931) Fixed “[Regression] sequtils.any conflicts with system.any” (#6932) Fixed “C++ codegen: mitems generates invalid code.” (#4910) Fixed “seq.mitems produces invalid cpp codegen” (#6892) Fixed “Concepts regression” (#6108) Fixed “Generic iterable concept with array crashes compiler” (#6277) Fixed “C code generation “‘a’ is a pointer; did you mean to use ‘-&gt;’?”” (#6462) Fixed “--NimblePath fails if a - in path which is not followed by a number” (#6949) Fixed ““not registered in the selector” in asyncfile.close() for something that clearly was registered” (#6906) Fixed “strange frexp behavior” (#6353) Fixed “noreturn branches of case statements shouldn’t contribute to type” (#6885) Fixed “Type inference for ‘if’ statements changed” (#6980) Fixed “newest asyncdispatch recursion” (#6100) Fixed “Ambiguous identifier between set type and proc” (#6965) Fixed “Inconsistent behavior with sequence and string slicing” (#6223) Fixed “Unsupported OpenSSL library imported dynamically” (#5000) Fixed “nim check segfaults” (#6972) Fixed “GC deadlock” (#6988) Fixed “Create a seq without memory initialization” (#6401) Fixed “Fix bug for getch on Windows while using the arrow keys” (#6966) Fixed “runnableExamples doesn’t work in templates” (#7018) Fixed “runnableExamples doesn’t work with untyped statement blocks” (#7019) Fixed “Critical bug in parseBiggestFloat” (#7060) Fixed “[RFC] strformat.% should be gone” (#7078) Fixed “compiler crash on simple macro” (#7093) Fixed “Make newlines sane again” (#7089) Fixed “JS - Unicode enum string representation issue” (#6741) Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)” (#6989) Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)” (#6989) Fixed “Compiler crash: try expression with infix as” (#7116) Fixed “nimsuggest crash” (#7140) Fixed “[RFC] Reintroduce readChar” (#7072) Fixed “Copyright line needs updating” (#7129) Fixed “-0.0 doesn’t result in negative zero in VM” (#7079) Fixed “Windows large filesize” (#7121) Fixed “Securehash is not parsimonious with MD5 and other hash modules” (#6961) Fixed “os.findExe() shouldn’t look in current directory on posix, unless exe has a /” (#6939) Fixed “compiles(...) with fatal pragma causes compiler to exit early” (#7080) Fixed “NPE when compile macro that returns concrete value” (#5450) Fixed “Using a variable of type int | float causes internal compiler error” (#6946) Fixed “Unsigned integers could not be used as array indexes.” (#7153) Fixed “countdown with uint causes underflow” (#4220) Fixed “Inconsistent method call syntax” (#7200) Fixed “Impossible to create an empty const array” (#6853) Fixed “Strange UINT handling” (#3985) Fixed “Bad codegen when passing arg that is part of return value destination” (#6960) Fixed “No info about gcsafety in error message when global var is accessed in async proc” (#6186) Fixed “Resolving package vs. local import ambiguities” (#2819) Fixed “Internal error with type() operator” (#3711) Fixed “newAsyncSocket should raise an OS error plus other inconsistencies” (#4995) Fixed “mapLiterals fails with negative values” (#7215) Fixed “fmWrite doesn’t truncate file with openAsync, unlike open()” (#5531) Fixed “Move libsvm to an external nimble module” (#5786) Fixed “Prevent acceptAddr gotcha with newSocket” (#7227) Fixed “strtabs.getOrDefault is inconsistent with tables.getOrDefault” (#4265) Fixed “Code falling through into exception handler when no exception thrown.” (#7232) Fixed “the new generic inference rules are broken” (#7247) Fixed “Odd ..&lt; regression” (#6992) Fixed “Different proc type inferred from default parameter” (#4659) Fixed “Different proc type inferred from default parameter” (#4659) Fixed “Testament sometimes ignores test failures” (#7236) Fixed “New Allocator Fails On &gt;=4GB Requests” (#7120) Fixed “User pragmas hide effect specifications from sempass2” (#7216) Fixed “C++: SIGABRT instead of IndexError for out-of-bounds” (#6512) Fixed “An uncaught exception in cpp mode doesn’t show the exception name/msg” (#6431)">
  

  <!-- <meta name="twitter:site" content="@nim_lang"> -->
  <!-- <meta name="twitter:card" content="summary_large_image"> -->
  <!-- <meta name="twitter:image" content="https://nim-lang.org/assets/img/twitter_banner.png">  -->

  <meta property="og:title" content="Version 0.18.0 released" />
  <meta property="og:site_name" content="Nim中文社区" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://nim-lang-cn.org/assets/img/twitter_banner.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1000" />
  <meta property="og:image:height" content="500" />
  <meta property="og:image:alt" content="Nim中文" />

  <meta name="copyright" content="Nim中文社区">

  <!-- SEO START -->
  <!-- baidu -->
  <meta name="baidu-site-verification" content="D5uE3gaRue" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-144592616-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-144592616-1');
  </script>
  <!-- bing -->
  <meta name="msvalidate.01" content="664E5CE055C5DCC50BB1238208911CDF" />
  <!-- yandex -->
  <meta name="yandex-verification" content="24900ce4c46b3893" />
  <!-- SEO END -->

  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
</head>

  <body class="site">
    <header>
  <nav class="pure-menu pure-menu-horizontal pure-menu-scrollable">
    <div class="nav-content">
      <a href="https://nim-lang-cn.org/" class="pure-menu-heading pure-menu-link site-logo-container">
        <img class="site-logo" src="https://nim-lang-cn.org/assets/img/logo.svg" height="28" alt="Nim">
      </a>
      <ul class="pure-menu-list">
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://tea.nim-lang-cn.org/">早茶</a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://nim-lang-cn.org/blog.html"
             class="pure-menu-link ">
            博客
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://nim-lang-cn.org/features.html"
             class="pure-menu-link ">
            特点
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://nim-lang-cn.org/install.html"
             class="pure-menu-link ">
            下载
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://nim-lang-cn.org/documentation.html"
             class="pure-menu-link ">
            Documentation
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://nim-lang-cn.org/community.html"
             class="pure-menu-link ">
            社区
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://github.com/nim-lang/Nim">源码</a>
        </li>
      </ul>
    </div>
    <div class="menu-fade"></div>
  </nav>
</header>

    <div class="site-content post-page">
      <div class="content">
        <div class="width-reduced">
          <h1 class="post-title">
            Version 0.18.0 released
          </h1>
          <h3 class="post-meta">
            <span>
              <i class="far fa-calendar-alt" aria-hidden="true"></i>
              01 March 2018
            </span>
            
            <span>
              <i class="fa fa-user-circle" aria-hidden="true"></i>
              The Nim Team
            </span>
            
          </h3>
          <p>The Nim team is happy to announce that the latest release of Nim,
version 0.18.0, is now available. Nim is a systems programming language that
focuses on performance, portability and expressiveness.</p>

<h1 id="installing-0180">Installing 0.18.0</h1>

<p>If you have installed a previous version of Nim using <code class="language-plaintext highlighter-rouge">choosenim</code>,
getting Nim 0.18.0 is as easy as:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>choosenim update stable
</code></pre></div></div>

<p>If you don’t have it already, you can get <code class="language-plaintext highlighter-rouge">choosenim</code> by following
<a href="https://github.com/dom96/choosenim">these instructions</a> or you can install
Nim manually by following the instructions on our
<a href="https://nim-lang.org/install.html">install</a> page.
Note that Windows users might still have an easier time with the
unzip+finish.exe method of installing Nim which is described on the
<a href="https://nim-lang.org/install.html">install</a> page.</p>

<h1 id="whats-new-in-0180">What’s new in 0.18.0</h1>

<p>It’s been a while since our last release, but we’ve been busy. At over 1000
commits since the last release, v0.18.0 is one of (if not the) biggest releases
of Nim ever.</p>

<p>We have mentioned multiple times that this will be a major release. Primarily
because our goal has been to clean up the standard library significantly in
preparation for v1.0. We’ve made massive progress in this release to achieve
that goal. The downside is that this release has a much larger proportion of
breaking changes than normal releases, but it is all in the spirit of a cleaner
Nim v1.0.</p>

<h2 id="breaking-changes-to-be-mindful-of">Breaking changes to be mindful of</h2>

<p>You will find that the <code class="language-plaintext highlighter-rouge">[]</code> indexing operator which takes a slice now raises
an <code class="language-plaintext highlighter-rouge">IndexError</code> exception when it is out of bounds. Previously it would have
simply returned the part of the string that was captured. You may find that your
program hasn’t taken this into account and will now crash with an <code class="language-plaintext highlighter-rouge">IndexError</code>
exception. To get back the previous behaviour, use the <code class="language-plaintext highlighter-rouge">substr</code> procedure.
Here is an example of the issue and how to get around it:</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">myString</span> <span class="o">=</span> <span class="s">"hello world"</span>
<span class="n">doAssertRaises</span> <span class="n">IndexError</span><span class="p">:</span>
  <span class="k">discard</span> <span class="n">myString</span><span class="o">[</span><span class="mi">6</span> <span class="p">..</span> <span class="mi">45</span><span class="o">]</span>
<span class="n">doAssert</span> <span class="n">myString</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span> <span class="o">==</span> <span class="s">"world"</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">$</code> operator now handles collections differently. For example:</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">doAssert</span> <span class="o">$</span><span class="p">(</span><span class="o">@[</span><span class="s">"23"</span><span class="p">,</span> <span class="s">"12"</span><span class="o">]</span><span class="p">)</span> <span class="o">==</span> <span class="s">"@[</span><span class="se">\"</span><span class="s">23</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">12</span><span class="se">\"</span><span class="s">]"</span>

<span class="c"># Whereas in 0.17.2:</span>
<span class="n">doAssert</span> <span class="o">$</span><span class="p">(</span><span class="o">@[</span><span class="s">"23"</span><span class="p">,</span> <span class="s">"12"</span><span class="o">]</span><span class="p">)</span> <span class="o">==</span> <span class="s">"@[23, 12]"</span>
</code></pre></div></div>

<p>An <code class="language-plaintext highlighter-rouge">array[x, char]</code> can no longer be converted to a <code class="language-plaintext highlighter-rouge">cstring</code> type. This
has the side-effect of allowing <code class="language-plaintext highlighter-rouge">$</code> to be defined on an array:</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">x</span><span class="p">:</span> <span class="kt">array</span><span class="o">[</span><span class="mi">5</span><span class="p">,</span> <span class="kt">char</span><span class="o">]</span>

<span class="n">doAssert</span> <span class="o">$</span><span class="n">x</span> <span class="o">==</span> <span class="s">r"['\x00', '\x00', '\x00', '\x00', '\x00']"</span>
</code></pre></div></div>

<p>Be sure to check out the changelog below for a comprehensive list of
breaking changes. If you run into any strange regressions feel free to pop into
IRC, Gitter, Discord or any of the other chat rooms/forums we have available.
Links to them all are available in our <a href="https://nim-lang.org/community.html">community page</a>.</p>

<h2 id="new-features">New features</h2>

<p>Of course, this being a major new release, there are also plenty of new
features.</p>

<h2 id="formatted-string-literals">Formatted string literals</h2>

<p>The greatest new addition is the <code class="language-plaintext highlighter-rouge">strformat</code> module. It implements string
formatting that is very similar to Python 3’s f-strings.</p>

<p>Formatted string literals are prefixed with <code class="language-plaintext highlighter-rouge">fmt</code> or the <code class="language-plaintext highlighter-rouge">&amp;</code> operator:</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">strformat</span>

<span class="k">let</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Fred"</span>
<span class="k">let</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">24</span>
<span class="k">let</span> <span class="n">weight</span> <span class="o">=</span> <span class="mf">94.52</span>

<span class="n">doAssert</span> <span class="s">fmt"My name is {name}. I'm {age} years of age and weigh {weight:.3f}."</span> <span class="o">==</span>
            <span class="s">"My name is Fred. I'm 24 years of age and weigh 94.520."</span>
</code></pre></div></div>

<p>For more information, take a look at the
<a href="https://nim-lang.org/docs/strformat.html"><code class="language-plaintext highlighter-rouge">strformat</code> documentation</a>.</p>

<h2 id="testable-documentation-examples">Testable documentation examples</h2>

<p>The documentation generator can now test your examples for you! This is done
using the new <code class="language-plaintext highlighter-rouge">runnableExamples</code> macro.</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">proc </span><span class="nf">add</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="kt">int</span><span class="p">):</span> <span class="kt">int</span> <span class="o">=</span>
  <span class="sd">## Adds two numbers together.</span>
  <span class="sd">##</span>
  <span class="sd">## Examples:</span>
  <span class="sd">##</span>
  <span class="n">runnableExamples</span><span class="p">:</span>
    <span class="n">doAssert</span> <span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span>
    <span class="n">doAssert</span> <span class="n">add</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span>

  <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div></div>

<p>If you save this as <code class="language-plaintext highlighter-rouge">addLib.nim</code> and then generate its documentation via
<code class="language-plaintext highlighter-rouge">nim doc addLib.nim</code>, you should see something like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hint: /tmp/addLib_examples  [Exec]
Hint: operation successful (13129 lines compiled; 0.492 sec total; 19.742MiB peakmem; Debug Build) [SuccessX]
</code></pre></div></div>

<p>The code under <code class="language-plaintext highlighter-rouge">runnableExamples</code> will be embedded in the procedure’s
documentation.</p>

<p>If your examples have an error in them then you will see it, together with a
stack trace if your error occurs at runtime.
This is great for ensuring that your documentation is up-to-date.</p>

<h2 id="mapliterals"><code class="language-plaintext highlighter-rouge">mapLiterals</code></h2>

<p>This is a new macro that allows you to easily create array and sequence literals.</p>

<div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">sequtils</span>

<span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="n">mapLiterals</span><span class="p">(</span><span class="o">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="n">uint32</span><span class="p">)</span>
<span class="n">doAssert</span> <span class="n">x</span> <span class="ow">is</span> <span class="kt">array</span><span class="o">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">uint32</span><span class="o">]</span>
</code></pre></div></div>

<h2 id="new-memory-manager-algorithm">New memory manager algorithm</h2>

<p>The new TLSF algorithm has been implemented to reduce memory fragmentation.
This has a side effect of making <code class="language-plaintext highlighter-rouge">alloc</code> and <code class="language-plaintext highlighter-rouge">dealloc</code> O(1) operations.</p>

<h2 id="async-improvements">Async improvements</h2>

<p>There have been a number of various improvements to the asynchronous IO
modules in the stdlib. There is no longer an “upcoming” and standard
asyncdispatch split, the former was merged and is now the default asyncdispatch
implementation.</p>

<p>A new <code class="language-plaintext highlighter-rouge">getIoHandler</code> procedure is now available, it returns a handle
to the underlying IO completion port or epoll/kqueue fd used by asyncdispatch.
Main advantage of this is that libraries now have even greater control over the
event loop.
As an example, it allows much more efficient HTTP server implementations
(one such implementation is called <a href="https://github.com/dom96/httpbeast">httpbeast</a>).</p>

<p>A new implementation of async await has also been added for the JavaScript
backend in the <code class="language-plaintext highlighter-rouge">asyncjs</code> module.</p>

<h2 id="nimble-v0810">Nimble v0.8.10</h2>

<p>In the release are also updates to the Nim package manager. The latest version
of Nimble is included and contains multiple new features and bug fixes.</p>

<p>The major new feature is the support for multiple Nimble packages in a single
Git/Hg repository.</p>

<p>Check out the
<a href="https://github.com/nim-lang/nimble/blob/master/changelog.markdown">changelog</a>
for a list of changes since Nimble’s last release.</p>

<h2 id="contributors-to-v0180">Contributors to v0.18.0</h2>

<p>Our contributors are amazing, and there is
<a href="https://github.com/nim-lang/Nim/graphs/contributors">far too many</a> to list
here. Big thanks to all of you, we couldn’t have pulled off this release
without you!</p>

<h1 id="changelog">Changelog</h1>

<h2 id="changes-affecting-backwards-compatibility">Changes affecting backwards compatibility</h2>

<h3 id="breaking-changes-in-the-standard-library">Breaking changes in the standard library</h3>

<ul>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">[]</code> proc for strings now raises an <code class="language-plaintext highlighter-rouge">IndexError</code> exception when
the specified slice is out of bounds. See issue
<a href="https://github.com/nim-lang/Nim/issues/6223">#6223</a> for more details.
You can use <code class="language-plaintext highlighter-rouge">substr(str, start, finish)</code> to get the old behaviour back,
see <a href="https://github.com/nim-lang/nimbot/commit/98cc031a27ea89947daa7f0bb536bcf86462941f">this commit</a> for an example.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">strutils.split</code> and <code class="language-plaintext highlighter-rouge">strutils.rsplit</code> with an empty string and a
separator now returns that empty string.
See issue <a href="https://github.com/nim-lang/Nim/issues/4377">#4377</a>.</p>
  </li>
  <li>
    <p>Arrays of char cannot be converted to <code class="language-plaintext highlighter-rouge">cstring</code> anymore, pointers to
arrays of char can! This means <code class="language-plaintext highlighter-rouge">$</code> for arrays can finally exist
in <code class="language-plaintext highlighter-rouge">system.nim</code> and do the right thing. This means <code class="language-plaintext highlighter-rouge">$myArrayOfChar</code> changed
its behaviour! Compile with <code class="language-plaintext highlighter-rouge">-d:nimNoArrayToString</code> to see where to fix your
code.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">reExtended</code> is no longer default for the <code class="language-plaintext highlighter-rouge">re</code> constructor in the <code class="language-plaintext highlighter-rouge">re</code>
module.</p>
  </li>
  <li>
    <p>The behavior of <code class="language-plaintext highlighter-rouge">$</code> has been changed for all standard library collections. The
collection-to-string implementations now perform proper quoting and escaping of
strings and chars.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">newAsyncSocket</code> taking an <code class="language-plaintext highlighter-rouge">AsyncFD</code> now runs <code class="language-plaintext highlighter-rouge">setBlocking(false)</code> on the
fd.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">mod</code> and bitwise <code class="language-plaintext highlighter-rouge">and</code> do not produce <code class="language-plaintext highlighter-rouge">range</code> subtypes anymore. This
turned out to be more harmful than helpful and the language is simpler
without this special typing rule.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">formatFloat</code>/<code class="language-plaintext highlighter-rouge">formatBiggestFloat</code> now support formatting floats with zero
precision digits. The previous <code class="language-plaintext highlighter-rouge">precision = 0</code> behavior (default formatting)
is now available via <code class="language-plaintext highlighter-rouge">precision = -1</code>.</p>
  </li>
  <li>Moved from stdlib into Nimble packages:
    <ul>
      <li><a href="https://github.com/nim-lang/basic2d"><code class="language-plaintext highlighter-rouge">basic2d</code></a>
<em>deprecated: use <code class="language-plaintext highlighter-rouge">glm</code>, <code class="language-plaintext highlighter-rouge">arraymancer</code>, <code class="language-plaintext highlighter-rouge">neo</code>, or another package instead</em></li>
      <li><a href="https://github.com/nim-lang/basic3d"><code class="language-plaintext highlighter-rouge">basic3d</code></a>
<em>deprecated: use <code class="language-plaintext highlighter-rouge">glm</code>, <code class="language-plaintext highlighter-rouge">arraymancer</code>, <code class="language-plaintext highlighter-rouge">neo</code>, or another package instead</em></li>
      <li><a href="https://github.com/lcrees/gentabs"><code class="language-plaintext highlighter-rouge">gentabs</code></a></li>
      <li><a href="https://github.com/lcrees/libuv"><code class="language-plaintext highlighter-rouge">libuv</code></a></li>
      <li><a href="https://github.com/lcrees/polynumeric"><code class="language-plaintext highlighter-rouge">polynumeric</code></a></li>
      <li><a href="https://github.com/lcrees/pdcurses"><code class="language-plaintext highlighter-rouge">pdcurses</code></a></li>
      <li><a href="https://github.com/lcrees/romans"><code class="language-plaintext highlighter-rouge">romans</code></a></li>
      <li><a href="https://github.com/nim-lang/libsvm_legacy"><code class="language-plaintext highlighter-rouge">libsvm</code></a></li>
      <li><a href="https://github.com/nim-lang/joyent_http_parser"><code class="language-plaintext highlighter-rouge">joyent_http_parser</code></a></li>
    </ul>
  </li>
  <li>
    <p>Proc <a href="https://nim-lang.org/docs/tables.html#toCountTable,openArray[A]">toCountTable</a>
now produces a <code class="language-plaintext highlighter-rouge">CountTable</code> with values corresponding to the number of occurrences
of the key in the input. It used to produce a table with all values set to <code class="language-plaintext highlighter-rouge">1</code>.</p>

    <p>Counting occurrences in a sequence used to be:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">mySeq</span> <span class="o">=</span> <span class="o">@[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">]</span>
<span class="k">var</span> <span class="n">myCounter</span> <span class="o">=</span> <span class="n">initCountTable</span><span class="o">[</span><span class="kt">int</span><span class="o">]</span><span class="p">()</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mySeq</span><span class="p">:</span>
  <span class="n">myCounter</span><span class="p">.</span><span class="n">inc</span> <span class="n">item</span>
</code></pre></div>    </div>

    <p>Now, you can simply do:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span>
  <span class="n">mySeq</span> <span class="o">=</span> <span class="o">@[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">]</span>
  <span class="n">myCounter</span> <span class="o">=</span> <span class="n">mySeq</span><span class="p">.</span><span class="n">toCountTable</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>If you use <code class="language-plaintext highlighter-rouge">--dynlibOverride:ssl</code> with OpenSSL 1.0.x, you now have to
define <code class="language-plaintext highlighter-rouge">openssl10</code> symbol (<code class="language-plaintext highlighter-rouge">-d:openssl10</code>). By default OpenSSL 1.1.x is
assumed.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">newNativeSocket</code> is now named <code class="language-plaintext highlighter-rouge">createNativeSocket</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">newAsyncNativeSocket</code> is now named <code class="language-plaintext highlighter-rouge">createAsyncNativeSocket</code>
and it no longer raises an OS error but returns an <code class="language-plaintext highlighter-rouge">osInvalidSocket</code> when
creation fails.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">securehash</code> module is now deprecated. Instead import <code class="language-plaintext highlighter-rouge">std / sha1</code>.</p>
  </li>
  <li>The <code class="language-plaintext highlighter-rouge">readPasswordFromStdin</code> proc has been moved from the <code class="language-plaintext highlighter-rouge">rdstdin</code>
to the <code class="language-plaintext highlighter-rouge">terminal</code> module, thus it does not depend on linenoise anymore.</li>
</ul>

<h3 id="breaking-changes-in-the-compiler">Breaking changes in the compiler</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">\n</code> is now only the single line feed character like in most
other programming languages. The new platform specific newline escape sequence is
written as <code class="language-plaintext highlighter-rouge">\p</code>. This change only affects the Windows platform.</p>
  </li>
  <li>
    <p>The overloading rules changed slightly so that constrained generics are
preferred over unconstrained generics. (Bug #6526)</p>
  </li>
  <li>
    <p>We changed how array accesses “from backwards” like <code class="language-plaintext highlighter-rouge">a[^1]</code> or <code class="language-plaintext highlighter-rouge">a[0..^1]</code> are
implemented. These are now implemented purely in <code class="language-plaintext highlighter-rouge">system.nim</code> without compiler
support. There is a new “heterogeneous” slice type <code class="language-plaintext highlighter-rouge">system.HSlice</code> that takes 2
generic parameters which can be <code class="language-plaintext highlighter-rouge">BackwardsIndex</code> indices. <code class="language-plaintext highlighter-rouge">BackwardsIndex</code> is
produced by <code class="language-plaintext highlighter-rouge">system.^</code>.
This means if you overload <code class="language-plaintext highlighter-rouge">[]</code> or <code class="language-plaintext highlighter-rouge">[]=</code> you need to ensure they also work
with <code class="language-plaintext highlighter-rouge">system.BackwardsIndex</code> (if applicable for the accessors).</p>
  </li>
  <li>
    <p>The parsing rules of <code class="language-plaintext highlighter-rouge">if</code> expressions were changed so that multiple
statements are allowed in the branches. We found few code examples that
now fail because of this change, but here is one:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t</span><span class="o">[</span><span class="n">ti</span><span class="o">]</span> <span class="o">=</span> <span class="k">if</span> <span class="n">exp_negative</span><span class="p">:</span> <span class="sc">'-'</span> <span class="k">else</span><span class="p">:</span> <span class="sc">'+'</span><span class="p">;</span> <span class="n">inc</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>This now needs to be written as:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t</span><span class="o">[</span><span class="n">ti</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="k">if</span> <span class="n">exp_negative</span><span class="p">:</span> <span class="sc">'-'</span> <span class="k">else</span><span class="p">:</span> <span class="sc">'+'</span><span class="p">);</span> <span class="n">inc</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>The experimental overloading of the dot <code class="language-plaintext highlighter-rouge">.</code> operators now take
an <code class="language-plaintext highlighter-rouge">untyped</code> parameter as the field name, it used to be
a <code class="language-plaintext highlighter-rouge">static[string]</code>. You can use <code class="language-plaintext highlighter-rouge">when defined(nimNewDot)</code> to make
your code work with both old and new Nim versions.
See <a href="https://nim-lang.org/docs/manual.html#special-operators">special-operators</a>
for more information.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">yield</code> (or <code class="language-plaintext highlighter-rouge">await</code> which is mapped to <code class="language-plaintext highlighter-rouge">yield</code>) never worked reliably
in an array, seq or object constructor and is now prevented at compile-time.</p>
  </li>
</ul>

<h2 id="library-additions">Library additions</h2>

<ul>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">sequtils.mapLiterals</code> for easier construction of array and tuple literals.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">system.runnableExamples</code> to make examples in Nim’s documentation easier
to write and test. The examples are tested as the last step of
<code class="language-plaintext highlighter-rouge">nim doc</code>.</p>
  </li>
  <li>
    <p>Implemented <code class="language-plaintext highlighter-rouge">getIoHandler</code> proc in the <code class="language-plaintext highlighter-rouge">asyncdispatch</code> module that allows
you to retrieve the underlying IO Completion Port or <code class="language-plaintext highlighter-rouge">Selector[AsyncData]</code>
object in the specified dispatcher.</p>
  </li>
  <li>
    <p>For string formatting / interpolation a new module
called <a href="https://nim-lang.org/docs/strformat.html">strformat</a> has been added
to the stdlib.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">ReadyKey</code> type in the selectors module now contains an <code class="language-plaintext highlighter-rouge">errorCode</code>
field to help distinguish between <code class="language-plaintext highlighter-rouge">Event.Error</code> events.</p>
  </li>
  <li>
    <p>Implemented an <code class="language-plaintext highlighter-rouge">accept</code> proc that works on a <code class="language-plaintext highlighter-rouge">SocketHandle</code> in
<code class="language-plaintext highlighter-rouge">nativesockets</code>.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">algorithm.rotateLeft</code>.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">typetraits.$</code> as an alias for <code class="language-plaintext highlighter-rouge">typetraits.name</code>.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">system.getStackTraceEntries</code> that allows you to access the stack
trace in a structured manner without string parsing.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">parseutils.parseSaturatedNatural</code>.</p>
  </li>
  <li>
    <p>Added <code class="language-plaintext highlighter-rouge">macros.unpackVarargs</code>.</p>
  </li>
  <li>
    <p>Added support for asynchronous programming for the JavaScript backend using
the <code class="language-plaintext highlighter-rouge">asyncjs</code> module.</p>
  </li>
  <li>
    <p>Added true color support for some terminals. Example:</p>
    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">colors</span><span class="p">,</span> <span class="n">terminal</span>

<span class="k">const</span> <span class="n">Nim</span> <span class="o">=</span> <span class="s">"Efficient and expressive programming."</span>

<span class="k">var</span>
  <span class="n">fg</span> <span class="o">=</span> <span class="n">colYellow</span>
  <span class="n">bg</span> <span class="o">=</span> <span class="n">colBlue</span>
  <span class="kt">int</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">enableTrueColors</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mf">1</span><span class="p">..</span><span class="mi">15</span><span class="p">:</span>
  <span class="n">styledEcho</span> <span class="n">bgColor</span><span class="p">,</span> <span class="n">bg</span><span class="p">,</span> <span class="n">fgColor</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">Nim</span><span class="p">,</span> <span class="n">resetStyle</span>
  <span class="kt">int</span> <span class="o">-=</span> <span class="mf">0.01</span>
  <span class="n">fg</span> <span class="o">=</span> <span class="n">intensity</span><span class="p">(</span><span class="n">fg</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span>

<span class="n">setForegroundColor</span> <span class="n">colRed</span>
<span class="n">setBackgroundColor</span> <span class="n">colGreen</span>
<span class="n">styledEcho</span> <span class="s">"Red on Green."</span><span class="p">,</span> <span class="n">resetStyle</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="library-changes">Library changes</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">echo</code> now works with strings that contain <code class="language-plaintext highlighter-rouge">\0</code> (the binary zero is not
shown) and <code class="language-plaintext highlighter-rouge">nil</code> strings are equal to empty strings.</p>
  </li>
  <li>
    <p>JSON: Deprecated <code class="language-plaintext highlighter-rouge">getBVal</code>, <code class="language-plaintext highlighter-rouge">getFNum</code>, and <code class="language-plaintext highlighter-rouge">getNum</code> in favour of
<code class="language-plaintext highlighter-rouge">getBool</code>, <code class="language-plaintext highlighter-rouge">getFloat</code>, <code class="language-plaintext highlighter-rouge">getBiggestInt</code>. A new <code class="language-plaintext highlighter-rouge">getInt</code> procedure was also
added.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">rationals.toRational</code> now uses an algorithm based on continued fractions.
This means its results are more precise and it can’t run into an infinite loop
anymore.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">os.getEnv</code> now takes an optional <code class="language-plaintext highlighter-rouge">default</code> parameter that tells <code class="language-plaintext highlighter-rouge">getEnv</code>
what to return if the environment variable does not exist.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">random</code> procs in <code class="language-plaintext highlighter-rouge">random.nim</code> have all been deprecated. Instead use
the new <code class="language-plaintext highlighter-rouge">rand</code> procs. The module now exports the state of the random
number generator as type <code class="language-plaintext highlighter-rouge">Rand</code> so multiple threads can easily use their
own random number generators that do not require locking. For more information
about this rename see issue <a href="https://github.com/nim-lang/Nim/issues/6934">#6934</a></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">writeStackTrace</code> is now proclaimed to have no IO effect (even though it does)
so that it is more useful for debugging purposes.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">db_mysql</code> module: <code class="language-plaintext highlighter-rouge">DbConn</code> is now a <code class="language-plaintext highlighter-rouge">distinct</code> type that doesn’t expose the
details of the underlying <code class="language-plaintext highlighter-rouge">PMySQL</code> type.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">parseopt2</code> is now deprecated, use <code class="language-plaintext highlighter-rouge">parseopt</code> instead.</p>
  </li>
</ul>

<h2 id="language-additions">Language additions</h2>

<ul>
  <li>
    <p>It is now possible to forward declare object types so that mutually
recursive types can be created across module boundaries. See
<a href="https://nim-lang.org/docs/manual.html#package-level-objects">package level objects</a>
for more information.</p>
  </li>
  <li>
    <p>Added support for casting between integers of same bitsize in VM (compile time and nimscript).
This allows to, among other things, reinterpret signed integers as unsigned.</p>
  </li>
  <li>
    <p>Custom pragmas are now supported using pragma <code class="language-plaintext highlighter-rouge">pragma</code>, please see language
manual for details.</p>
  </li>
  <li>
    <p>Standard library modules can now also be imported via the <code class="language-plaintext highlighter-rouge">std</code> pseudo-directory.
This is useful in order to distinguish between standard library and nimble package
imports:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">std</span> <span class="o">/</span> <span class="o">[</span><span class="n">strutils</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">osproc</span><span class="o">]</span>
<span class="k">import</span> <span class="n">someNimblePackage</span> <span class="o">/</span> <span class="o">[</span><span class="n">strutils</span><span class="p">,</span> <span class="n">os</span><span class="o">]</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="language-changes">Language changes</h2>

<ul>
  <li>
    <p>The <strong>unary</strong> <code class="language-plaintext highlighter-rouge">&lt;</code> is now deprecated, for <code class="language-plaintext highlighter-rouge">.. &lt;</code> use <code class="language-plaintext highlighter-rouge">..&lt;</code> for other usages
use the <code class="language-plaintext highlighter-rouge">pred</code> proc.</p>
  </li>
  <li>
    <p>Bodies of <code class="language-plaintext highlighter-rouge">for</code> loops now get their own scope:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># now compiles:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mf">0</span><span class="p">..</span><span class="mi">4</span><span class="p">:</span>
  <span class="k">let</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="n">echo</span> <span class="n">i</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>To make Nim even more robust the system iterators <code class="language-plaintext highlighter-rouge">..</code> and <code class="language-plaintext highlighter-rouge">countup</code>
now only accept a single generic type <code class="language-plaintext highlighter-rouge">T</code>. This means the following code
doesn’t die with an “out of range” error anymore:</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">5.</span><span class="n">Natural</span>
<span class="k">var</span> <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">..</span><span class="n">b</span><span class="p">:</span>
  <span class="n">echo</span> <span class="n">i</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">atomic</code> and <code class="language-plaintext highlighter-rouge">generic</code> are no longer keywords in Nim. <code class="language-plaintext highlighter-rouge">generic</code> used to be
an alias for <code class="language-plaintext highlighter-rouge">concept</code>, <code class="language-plaintext highlighter-rouge">atomic</code> was not used for anything.</p>
  </li>
  <li>
    <p>The memory manager now uses a variant of the TLSF algorithm that has much
better memory fragmentation behaviour. According
to <a href="http://www.gii.upv.es/tlsf/">http://www.gii.upv.es/tlsf/</a> the maximum
fragmentation measured is lower than 25%. As a nice bonus <code class="language-plaintext highlighter-rouge">alloc</code> and
<code class="language-plaintext highlighter-rouge">dealloc</code> became O(1) operations.</p>
  </li>
  <li>
    <p>The compiler is now more consistent in its treatment of ambiguous symbols:
Types that shadow procs and vice versa are marked as ambiguous (bug #6693).</p>
  </li>
  <li>
    <p>codegenDecl pragma now works for the JavaScript backend. It returns an empty
string for function return type placeholders.</p>
  </li>
  <li>
    <p>Extra semantic checks for procs with noreturn pragma: return type is not allowed,
statements after call to noreturn procs are no longer allowed.</p>
  </li>
  <li>Noreturn proc calls and raising exceptions branches are now skipped during common type
deduction in <code class="language-plaintext highlighter-rouge">if</code> and <code class="language-plaintext highlighter-rouge">case</code> expressions. The following code snippets now compile:
    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="n">strutils</span>
<span class="k">let</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"Y"</span>
<span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="k">case</span> <span class="n">str</span><span class="p">:</span>
  <span class="k">of</span> <span class="s">"Y"</span><span class="p">:</span> <span class="kp">true</span>
  <span class="k">of</span> <span class="s">"N"</span><span class="p">:</span> <span class="kp">false</span>
  <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="n">newException</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span> <span class="s">"Invalid boolean"</span><span class="p">)</span>
<span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="k">case</span> <span class="n">str</span><span class="p">:</span>
  <span class="k">of</span> <span class="k">nil</span><span class="p">,</span> <span class="s">""</span><span class="p">:</span> <span class="k">raise</span> <span class="n">newException</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span> <span class="s">"Invalid boolean"</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">str</span><span class="p">.</span><span class="n">startsWith</span><span class="p">(</span><span class="s">"Y"</span><span class="p">):</span> <span class="kp">true</span>
  <span class="k">elif</span> <span class="n">str</span><span class="p">.</span><span class="n">startsWith</span><span class="p">(</span><span class="s">"N"</span><span class="p">):</span> <span class="kp">false</span>
  <span class="k">else</span><span class="p">:</span> <span class="kp">false</span>
<span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="k">if</span> <span class="n">str</span> <span class="o">==</span> <span class="s">"Y"</span><span class="p">:</span> <span class="kp">true</span>
  <span class="k">elif</span> <span class="n">str</span> <span class="o">==</span> <span class="s">"N"</span><span class="p">:</span> <span class="kp">false</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">echo</span> <span class="s">"invalid bool"</span>
    <span class="n">quit</span><span class="p">(</span><span class="s">"this is the end"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Pragmas now support call syntax, for example: <code class="language-plaintext highlighter-rouge">{.exportc"myname".}</code> and
<code class="language-plaintext highlighter-rouge">{.exportc("myname").}</code></p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">deprecated</code> pragma now supports a user-definable warning message for procs.</p>

    <div class="language-nim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">proc </span><span class="nf">bar</span> <span class="p">{.</span><span class="n">deprecated</span><span class="p">:</span> <span class="s">"use foo instead"</span><span class="p">.}</span> <span class="o">=</span>
  <span class="k">return</span>

<span class="n">bar</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="tool-changes">Tool changes</h2>

<ul>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">nim doc</code> command is now an alias for <code class="language-plaintext highlighter-rouge">nim doc2</code>, the second version of
the documentation generator. The old version 1 can still be accessed
via the new <code class="language-plaintext highlighter-rouge">nim doc0</code> command.</p>
  </li>
  <li>
    <p>Nim’s <code class="language-plaintext highlighter-rouge">rst2html</code> command now supports the testing of code snippets via an RST
extension that we called <code class="language-plaintext highlighter-rouge">:test:</code>::</p>

    <pre><code class="language-rst">.. code-block:: nim
    :test:
  # shows how the 'if' statement works
  if true: echo "yes"
</code></pre>
  </li>
</ul>

<h2 id="bugfixes">Bugfixes</h2>

<ul>
  <li>Fixed “ReraiseError when using try/except within finally block”
(<a href="https://github.com/nim-lang/Nim/issues/5871">#5871</a>)</li>
  <li>Fixed “Range type inference leads to counter-intuitive behvaiour”
(<a href="https://github.com/nim-lang/Nim/issues/5854">#5854</a>)</li>
  <li>Fixed “JSON % operator can fail in extern procs with dynamic types”
(<a href="https://github.com/nim-lang/Nim/issues/6385">#6385</a>)</li>
  <li>Fixed ““intVal is not accessible” in VM”
(<a href="https://github.com/nim-lang/Nim/issues/6083">#6083</a>)</li>
  <li>Fixed “Add excl for OrderedSet”
(<a href="https://github.com/nim-lang/Nim/issues/2467">#2467</a>)</li>
  <li>Fixed “newSeqOfCap actually doesn’t reserve memory”
(<a href="https://github.com/nim-lang/Nim/issues/6403">#6403</a>)</li>
  <li>Fixed “[Regression] Nim segfaults”
(<a href="https://github.com/nim-lang/Nim/issues/6435">#6435</a>)</li>
  <li>Fixed “Seq assignment is slower than expected”
(<a href="https://github.com/nim-lang/Nim/issues/6433">#6433</a>)</li>
  <li>Fixed “json module issues with empty dicts and lists”
(<a href="https://github.com/nim-lang/Nim/issues/6438">#6438</a>)</li>
  <li>Fixed “mingw installed via finish.exe fails to link if Nim located in path with whitespace”
(<a href="https://github.com/nim-lang/Nim/issues/6452">#6452</a>)</li>
  <li>Fixed “unittest.check does not perform short-circuit evaluation”
(<a href="https://github.com/nim-lang/Nim/issues/5784">#5784</a>)</li>
  <li>Fixed “Error while concatenating an array of chars.”
(<a href="https://github.com/nim-lang/Nim/issues/5861">#5861</a>)</li>
  <li>Fixed “range initialization: [ProveInit] hint: Cannot prove that”
(<a href="https://github.com/nim-lang/Nim/issues/6474">#6474</a>)</li>
  <li>Fixed “scanf can call procs with side-effects multiple times”
(<a href="https://github.com/nim-lang/Nim/issues/6487">#6487</a>)</li>
  <li>Fixed “gcsafe detection problem”
(<a href="https://github.com/nim-lang/Nim/issues/5620">#5620</a>)</li>
  <li>Fixed “C++ codegen: <code class="language-plaintext highlighter-rouge">mitems</code> generates invalid code.”
(<a href="https://github.com/nim-lang/Nim/issues/4910">#4910</a>)</li>
  <li>Fixed “strange runtime behavior on macOS”
(<a href="https://github.com/nim-lang/Nim/issues/6496">#6496</a>)</li>
  <li>Fixed “stdtmpl: invalid indentation after a line ending in question mark”
(<a href="https://github.com/nim-lang/Nim/issues/5070">#5070</a>)</li>
  <li>Fixed “Windows: NAN troubles on c backend”
(<a href="https://github.com/nim-lang/Nim/issues/6511">#6511</a>)</li>
  <li>Fixed “lib/nim/system/cellsets.nim(33, 31) Error: type mismatch while attempting to compile for 16bit CPUs”
(<a href="https://github.com/nim-lang/Nim/issues/3558">#3558</a>)</li>
  <li>Fixed “Can’t compile dynlib with <code class="language-plaintext highlighter-rouge">-d:useNimRtl</code> and <code class="language-plaintext highlighter-rouge">--threads:on</code>”
(<a href="https://github.com/nim-lang/Nim/issues/5143">#5143</a>)</li>
  <li>Fixed “var s = @[0,1,2,…] can generate thousand of single assignments in C code”
(<a href="https://github.com/nim-lang/Nim/issues/5007">#5007</a>)</li>
  <li>Fixed “<code class="language-plaintext highlighter-rouge">echo</code> discards everything after a null character”
(<a href="https://github.com/nim-lang/Nim/issues/1137">#1137</a>)</li>
  <li>Fixed “Turn off reExtended by default”
(<a href="https://github.com/nim-lang/Nim/issues/5627">#5627</a>)</li>
  <li>Fixed “Bad Links in docs/backends.html”
(<a href="https://github.com/nim-lang/Nim/issues/5914">#5914</a>)</li>
  <li>Fixed “Index out of bounds error in db_postgres when executing non parameter-substituted queries containing “?””
(<a href="https://github.com/nim-lang/Nim/issues/6571">#6571</a>)</li>
  <li>Fixed “Please add pipe2 support to posix stdlib”
(<a href="https://github.com/nim-lang/Nim/issues/6553">#6553</a>)</li>
  <li>Fixed “Return semantics vary depending on return style”
(<a href="https://github.com/nim-lang/Nim/issues/6422">#6422</a>)</li>
  <li>Fixed “parsecsv.open reports SIGSEGV when calling ‘open’ on missing file”
(<a href="https://github.com/nim-lang/Nim/issues/6148">#6148</a>)</li>
  <li>Fixed “VCC: Nim generates non-compilable code for system.nim”
(<a href="https://github.com/nim-lang/Nim/issues/6606">#6606</a>)</li>
  <li>Fixed “Generic subtype matches worse than a generic”
(<a href="https://github.com/nim-lang/Nim/issues/6526">#6526</a>)</li>
  <li>Fixed “formatFloat inconsistent scientific notation”
(<a href="https://github.com/nim-lang/Nim/issues/6589">#6589</a>)</li>
  <li>Fixed “Generated c code calls function twice”
(<a href="https://github.com/nim-lang/Nim/issues/6292">#6292</a>)</li>
  <li>Fixed “Range type inference leads to counter-intuitive behvaiour”
(<a href="https://github.com/nim-lang/Nim/issues/5854">#5854</a>)</li>
  <li>Fixed “New backward indexing is too limited”
(<a href="https://github.com/nim-lang/Nim/issues/6631">#6631</a>)</li>
  <li>Fixed “Table usage in a macro (SIGSEGV: Illegal storage access.)”
(<a href="https://github.com/nim-lang/Nim/issues/1860">#1860</a>)</li>
  <li>Fixed “Incorrect deprecation error”
(<a href="https://github.com/nim-lang/Nim/issues/6634">#6634</a>)</li>
  <li>Fixed “Wrong indices in arrays not starting with 0”
(<a href="https://github.com/nim-lang/Nim/issues/6675">#6675</a>)</li>
  <li>Fixed “if expressions”
(<a href="https://github.com/nim-lang/Nim/issues/6609">#6609</a>)</li>
  <li>Fixed “BackwardsIndex: converter + <code class="language-plaintext highlighter-rouge">[]</code> + unrelated type[^1]: lib/system.nim(3536, 3) Error”
(<a href="https://github.com/nim-lang/Nim/issues/6692">#6692</a>)</li>
  <li>Fixed “js backend 0.17.3: array bounds check for non zero based arrays is buggy”
(<a href="https://github.com/nim-lang/Nim/issues/6532">#6532</a>)</li>
  <li>Fixed “HttpClient’s new API doesn’t work through a proxy for https URLs”
(<a href="https://github.com/nim-lang/Nim/issues/6685">#6685</a>)</li>
  <li>Fixed “isServing isn’t declared and isn’t compiling”
(<a href="https://github.com/nim-lang/Nim/issues/6707">#6707</a>)</li>
  <li>
    <p>Fixed “[Regression] value out of range”
(<a href="https://github.com/nim-lang/Nim/issues/6710">#6710</a>)</p>
  </li>
  <li>
    <p>Fixed “Error when using <code class="language-plaintext highlighter-rouge">multisync</code> macro”
(<a href="https://github.com/nim-lang/Nim/issues/6708">#6708</a>)</p>
  </li>
  <li>Fixed “formatFloat inconsistent scientific notation”
(<a href="https://github.com/nim-lang/Nim/issues/6589">#6589</a>)</li>
  <li>Fixed “Using : (constructor arguments) for passing values to functions with default arguments causes a compiler crash.”
(<a href="https://github.com/nim-lang/Nim/issues/6765">#6765</a>)</li>
  <li>Fixed “In-place object initialization leads to vcc incompatible code”
(<a href="https://github.com/nim-lang/Nim/issues/6757">#6757</a>)</li>
  <li>Fixed “Improve parseCookies doc”
(<a href="https://github.com/nim-lang/Nim/issues/5721">#5721</a>)</li>
  <li>Fixed “Parser regression with nested do notation inside conditional”
(<a href="https://github.com/nim-lang/Nim/issues/6166">#6166</a>)</li>
  <li>Fixed “Request for better error message”
(<a href="https://github.com/nim-lang/Nim/issues/6776">#6776</a>)</li>
  <li>Fixed “Testament tester does not execute test with <code class="language-plaintext highlighter-rouge">exitcode</code> only”
(<a href="https://github.com/nim-lang/Nim/issues/6775">#6775</a>)</li>
  <li>Fixed “JS integer division off by one”
(<a href="https://github.com/nim-lang/Nim/issues/6753">#6753</a>)</li>
  <li>Fixed “Regression: cannot prove not nil”
(<a href="https://github.com/nim-lang/Nim/issues/5781">#5781</a>)</li>
  <li>Fixed “SIGSEGV: Illegal storage access. (Attempt to read from nil?) in generic proc”
(<a href="https://github.com/nim-lang/Nim/issues/6073">#6073</a>)</li>
  <li>Fixed “Request for better error message”
(<a href="https://github.com/nim-lang/Nim/issues/6776">#6776</a>)</li>
  <li>Fixed “Nim #head: sorting via reference hangs compiler”
(<a href="https://github.com/nim-lang/Nim/issues/6724">#6724</a>)</li>
  <li>Fixed “Cannot cast pointer to char in cpp”
(<a href="https://github.com/nim-lang/Nim/issues/5979">#5979</a>)</li>
  <li>Fixed “asynchttpserver replies with several errors on single request”
(<a href="https://github.com/nim-lang/Nim/issues/6386">#6386</a>)</li>
  <li>Fixed “object variants superclass trigger bad codegen”
(<a href="https://github.com/nim-lang/Nim/issues/5521">#5521</a>)</li>
  <li>Fixed “JS integer division off by one”
(<a href="https://github.com/nim-lang/Nim/issues/6753">#6753</a>)</li>
  <li>Fixed “js backend compiler crash with tables indexed by certain types”
(<a href="https://github.com/nim-lang/Nim/issues/6568">#6568</a>)</li>
  <li>Fixed “Jsgen bug with is”
(<a href="https://github.com/nim-lang/Nim/issues/6445">#6445</a>)</li>
  <li>Fixed “Subrange definition with ..&lt;”
(<a href="https://github.com/nim-lang/Nim/issues/6788">#6788</a>)</li>
  <li>Fixed “fields not initialized: array with enum index type as object field.”
(<a href="https://github.com/nim-lang/Nim/issues/6682">#6682</a>)</li>
  <li>Fixed “Can not delete data in table when table’s data type is kind of “not nil””
(<a href="https://github.com/nim-lang/Nim/issues/6555">#6555</a>)</li>
  <li>Fixed “tables.nim: Cannot prove that ‘n’ is initialized”
(<a href="https://github.com/nim-lang/Nim/issues/6121">#6121</a>)</li>
  <li>Fixed “issues with ‘not nil’ applied to a closure proc”
(<a href="https://github.com/nim-lang/Nim/issues/6489">#6489</a>)</li>
  <li>Fixed “<code class="language-plaintext highlighter-rouge">not nil</code> not working in some cases”
(<a href="https://github.com/nim-lang/Nim/issues/4686">#4686</a>)</li>
  <li>
    <p>Fixed “Cannot prove ‘@[v]’ is not nil”
(<a href="https://github.com/nim-lang/Nim/issues/3993">#3993</a>)</p>
  </li>
  <li>Fixed “Feature: support TCP_NODELAY in net.sockets”
(<a href="https://github.com/nim-lang/Nim/issues/6795">#6795</a>)</li>
  <li>Fixed “Code that makes the compiler throw an error message and then hangs”
(<a href="https://github.com/nim-lang/Nim/issues/6820">#6820</a>)</li>
  <li>Fixed “Code that makes the compiler throw an error message and then hangs”
(<a href="https://github.com/nim-lang/Nim/issues/6820">#6820</a>)</li>
  <li>Fixed “Inconsistent behavior with sequence and string slicing”
(<a href="https://github.com/nim-lang/Nim/issues/6223">#6223</a>)</li>
  <li>Fixed “Wrong behavior of “split” (proc and iterator)”
(<a href="https://github.com/nim-lang/Nim/issues/4377">#4377</a>)</li>
  <li>Fixed “[Documentation] Invalid module name: [foo, bar]”
(<a href="https://github.com/nim-lang/Nim/issues/6831">#6831</a>)</li>
  <li>Fixed “The destructor is not called for temporary objects”
(<a href="https://github.com/nim-lang/Nim/issues/4214">#4214</a>)</li>
  <li>Fixed “Destructors does not work with implicit items iterator in for loop”
(<a href="https://github.com/nim-lang/Nim/issues/985">#985</a>)</li>
  <li>Fixed “Error in template when using the type of the parameter inside it”
(<a href="https://github.com/nim-lang/Nim/issues/6756">#6756</a>)</li>
  <li>Fixed “should json.to() respect parent attributes?”
(<a href="https://github.com/nim-lang/Nim/issues/5856">#5856</a>)</li>
  <li>Fixed “json ‘to’ macro can not marshalize into tuples”
(<a href="https://github.com/nim-lang/Nim/issues/6095">#6095</a>)</li>
  <li>Fixed “json.to fails with seq[T]”
(<a href="https://github.com/nim-lang/Nim/issues/6604">#6604</a>)</li>
  <li>Fixed “json.to() is not worth using compared to marshal.to[T]”
(<a href="https://github.com/nim-lang/Nim/issues/5848">#5848</a>)</li>
  <li>Fixed “Memory not being released in time, running out of memory”
(<a href="https://github.com/nim-lang/Nim/issues/6031">#6031</a>)</li>
  <li>Fixed “[Regression] Bad C codegen for generic code”
(<a href="https://github.com/nim-lang/Nim/issues/6889">#6889</a>)</li>
  <li>Fixed “rollingFileLogger deletes file on every start.”
(<a href="https://github.com/nim-lang/Nim/issues/6264">#6264</a>)</li>
  <li>Fixed “Remove/deprecate securehash module.”
(<a href="https://github.com/nim-lang/Nim/issues/6033">#6033</a>)</li>
  <li>Fixed “[bug or not] object construction for seq[T] failed without space after colon”
(<a href="https://github.com/nim-lang/Nim/issues/5999">#5999</a>)</li>
  <li>Fixed “issues with the random module”
(<a href="https://github.com/nim-lang/Nim/issues/4726">#4726</a>)</li>
  <li>Fixed “Reassigning local var to seq of objects results in nil element in Object’s seq field”
(<a href="https://github.com/nim-lang/Nim/issues/668">#668</a>)</li>
  <li>Fixed “Compilation error with “newseq[string]””
(<a href="https://github.com/nim-lang/Nim/issues/6726">#6726</a>)</li>
  <li>Fixed “await inside array/dict literal produces invalid code - Part 2”
(<a href="https://github.com/nim-lang/Nim/issues/6626">#6626</a>)</li>
  <li>Fixed “terminal.eraseline() gives OverflowError on Windows”
(<a href="https://github.com/nim-lang/Nim/issues/6931">#6931</a>)</li>
  <li>Fixed “[Regression] <code class="language-plaintext highlighter-rouge">sequtils.any</code> conflicts with <code class="language-plaintext highlighter-rouge">system.any</code>”
(<a href="https://github.com/nim-lang/Nim/issues/6932">#6932</a>)</li>
  <li>Fixed “C++ codegen: <code class="language-plaintext highlighter-rouge">mitems</code> generates invalid code.”
(<a href="https://github.com/nim-lang/Nim/issues/4910">#4910</a>)</li>
  <li>Fixed “seq.mitems produces invalid cpp codegen”
(<a href="https://github.com/nim-lang/Nim/issues/6892">#6892</a>)</li>
  <li>Fixed “Concepts regression”
(<a href="https://github.com/nim-lang/Nim/issues/6108">#6108</a>)</li>
  <li>Fixed “Generic iterable concept with array crashes compiler”
(<a href="https://github.com/nim-lang/Nim/issues/6277">#6277</a>)</li>
  <li>Fixed “C code generation “‘a’ is a pointer; did you mean to use ‘-&gt;’?””
(<a href="https://github.com/nim-lang/Nim/issues/6462">#6462</a>)</li>
  <li>Fixed “<code class="language-plaintext highlighter-rouge">--NimblePath</code> fails if a <code class="language-plaintext highlighter-rouge">-</code> in path which is not followed by a number”
(<a href="https://github.com/nim-lang/Nim/issues/6949">#6949</a>)</li>
  <li>Fixed ““not registered in the selector” in asyncfile.close() for something that clearly was registered”
(<a href="https://github.com/nim-lang/Nim/issues/6906">#6906</a>)</li>
  <li>
    <p>Fixed “strange frexp behavior”
(<a href="https://github.com/nim-lang/Nim/issues/6353">#6353</a>)</p>
  </li>
  <li>Fixed “noreturn branches of case statements shouldn’t contribute to type”
(<a href="https://github.com/nim-lang/Nim/issues/6885">#6885</a>)</li>
  <li>Fixed “Type inference for ‘if’ statements changed”
(<a href="https://github.com/nim-lang/Nim/issues/6980">#6980</a>)</li>
  <li>Fixed “newest asyncdispatch recursion”
(<a href="https://github.com/nim-lang/Nim/issues/6100">#6100</a>)</li>
  <li>
    <p>Fixed “Ambiguous identifier between set type and proc”
(<a href="https://github.com/nim-lang/Nim/issues/6965">#6965</a>)</p>
  </li>
  <li>
    <p>Fixed “Inconsistent behavior with sequence and string slicing”
(<a href="https://github.com/nim-lang/Nim/issues/6223">#6223</a>)</p>
  </li>
  <li>Fixed “Unsupported OpenSSL library imported dynamically”
(<a href="https://github.com/nim-lang/Nim/issues/5000">#5000</a>)</li>
  <li>Fixed “<code class="language-plaintext highlighter-rouge">nim check</code> segfaults”
(<a href="https://github.com/nim-lang/Nim/issues/6972">#6972</a>)</li>
  <li>Fixed “GC deadlock”
(<a href="https://github.com/nim-lang/Nim/issues/6988">#6988</a>)</li>
  <li>Fixed “Create a seq without memory initialization”
(<a href="https://github.com/nim-lang/Nim/issues/6401">#6401</a>)</li>
  <li>Fixed “Fix bug for getch on Windows while using the arrow keys”
(<a href="https://github.com/nim-lang/Nim/issues/6966">#6966</a>)</li>
  <li>Fixed “runnableExamples doesn’t work in templates”
(<a href="https://github.com/nim-lang/Nim/issues/7018">#7018</a>)</li>
  <li>
    <p>Fixed “runnableExamples doesn’t work with untyped statement blocks”
(<a href="https://github.com/nim-lang/Nim/issues/7019">#7019</a>)</p>
  </li>
  <li>Fixed “Critical bug in parseBiggestFloat”
(<a href="https://github.com/nim-lang/Nim/issues/7060">#7060</a>)</li>
  <li>Fixed “[RFC] strformat.% should be gone”
(<a href="https://github.com/nim-lang/Nim/issues/7078">#7078</a>)</li>
  <li>Fixed “compiler crash on simple macro”
(<a href="https://github.com/nim-lang/Nim/issues/7093">#7093</a>)</li>
  <li>Fixed “Make newlines sane again”
(<a href="https://github.com/nim-lang/Nim/issues/7089">#7089</a>)</li>
  <li>Fixed “JS - Unicode enum string representation issue”
(<a href="https://github.com/nim-lang/Nim/issues/6741">#6741</a>)</li>
  <li>Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)”
(<a href="https://github.com/nim-lang/Nim/issues/6989">#6989</a>)</li>
  <li>Fixed “Strange behaviour of 0.17.3 (working ok in 0.17.2)”
(<a href="https://github.com/nim-lang/Nim/issues/6989">#6989</a>)</li>
  <li>Fixed “Compiler crash: try expression with infix as”
(<a href="https://github.com/nim-lang/Nim/issues/7116">#7116</a>)</li>
  <li>Fixed “nimsuggest crash”
(<a href="https://github.com/nim-lang/Nim/issues/7140">#7140</a>)</li>
  <li>Fixed “[RFC] Reintroduce readChar”
(<a href="https://github.com/nim-lang/Nim/issues/7072">#7072</a>)</li>
  <li>Fixed “Copyright line needs updating”
(<a href="https://github.com/nim-lang/Nim/issues/7129">#7129</a>)</li>
  <li>Fixed “-0.0 doesn’t result in negative zero in VM”
(<a href="https://github.com/nim-lang/Nim/issues/7079">#7079</a>)</li>
  <li>Fixed “Windows large filesize”
(<a href="https://github.com/nim-lang/Nim/issues/7121">#7121</a>)</li>
  <li>Fixed “Securehash is not parsimonious with MD5 and other hash modules”
(<a href="https://github.com/nim-lang/Nim/issues/6961">#6961</a>)</li>
  <li>Fixed “os.findExe() shouldn’t look in current directory on posix, unless exe has a /”
(<a href="https://github.com/nim-lang/Nim/issues/6939">#6939</a>)</li>
  <li>Fixed “<code class="language-plaintext highlighter-rouge">compiles(...)</code> with <code class="language-plaintext highlighter-rouge">fatal</code> pragma causes compiler to exit early”
(<a href="https://github.com/nim-lang/Nim/issues/7080">#7080</a>)</li>
  <li>Fixed “NPE when compile macro that returns concrete value”
(<a href="https://github.com/nim-lang/Nim/issues/5450">#5450</a>)</li>
  <li>Fixed “Using a variable of type <code class="language-plaintext highlighter-rouge">int | float</code> causes internal compiler error”
(<a href="https://github.com/nim-lang/Nim/issues/6946">#6946</a>)</li>
  <li>Fixed “Unsigned integers could not be used as array indexes.”
(<a href="https://github.com/nim-lang/Nim/issues/7153">#7153</a>)</li>
  <li>Fixed “countdown with uint causes underflow”
(<a href="https://github.com/nim-lang/Nim/issues/4220">#4220</a>)</li>
  <li>Fixed “Inconsistent method call syntax”
(<a href="https://github.com/nim-lang/Nim/issues/7200">#7200</a>)</li>
  <li>Fixed “Impossible to create an empty const array”
(<a href="https://github.com/nim-lang/Nim/issues/6853">#6853</a>)</li>
  <li>Fixed “Strange UINT handling”
(<a href="https://github.com/nim-lang/Nim/issues/3985">#3985</a>)</li>
  <li>Fixed “Bad codegen when passing arg that is part of return value destination”
(<a href="https://github.com/nim-lang/Nim/issues/6960">#6960</a>)</li>
  <li>Fixed “No info about gcsafety in error message when global var is accessed in async proc”
(<a href="https://github.com/nim-lang/Nim/issues/6186">#6186</a>)</li>
  <li>Fixed “Resolving package vs. local import ambiguities”
(<a href="https://github.com/nim-lang/Nim/issues/2819">#2819</a>)</li>
  <li>Fixed “Internal error with type() operator”
(<a href="https://github.com/nim-lang/Nim/issues/3711">#3711</a>)</li>
  <li>Fixed “newAsyncSocket should raise an OS error plus other inconsistencies”
(<a href="https://github.com/nim-lang/Nim/issues/4995">#4995</a>)</li>
  <li>Fixed “mapLiterals fails with negative values”
(<a href="https://github.com/nim-lang/Nim/issues/7215">#7215</a>)</li>
  <li>Fixed “fmWrite doesn’t truncate file with openAsync, unlike open()”
(<a href="https://github.com/nim-lang/Nim/issues/5531">#5531</a>)</li>
  <li>Fixed “Move libsvm to an external nimble module”
(<a href="https://github.com/nim-lang/Nim/issues/5786">#5786</a>)</li>
  <li>Fixed “Prevent acceptAddr gotcha with newSocket”
(<a href="https://github.com/nim-lang/Nim/issues/7227">#7227</a>)</li>
  <li>
    <p>Fixed “strtabs.getOrDefault is inconsistent with tables.getOrDefault”
(<a href="https://github.com/nim-lang/Nim/issues/4265">#4265</a>)</p>
  </li>
  <li>Fixed “Code falling through into exception handler when no exception thrown.”
(<a href="https://github.com/nim-lang/Nim/issues/7232">#7232</a>)</li>
  <li>Fixed “the new generic inference rules are broken”
(<a href="https://github.com/nim-lang/Nim/issues/7247">#7247</a>)</li>
  <li>Fixed “Odd <code class="language-plaintext highlighter-rouge">..&lt;</code> regression”
(<a href="https://github.com/nim-lang/Nim/issues/6992">#6992</a>)</li>
  <li>Fixed “Different proc type inferred from default parameter”
(<a href="https://github.com/nim-lang/Nim/issues/4659">#4659</a>)</li>
  <li>Fixed “Different proc type inferred from default parameter”
(<a href="https://github.com/nim-lang/Nim/issues/4659">#4659</a>)</li>
  <li>Fixed “Testament sometimes ignores test failures”
(<a href="https://github.com/nim-lang/Nim/issues/7236">#7236</a>)</li>
  <li>Fixed “New Allocator Fails On &gt;=4GB Requests”
(<a href="https://github.com/nim-lang/Nim/issues/7120">#7120</a>)</li>
  <li>Fixed “User pragmas hide effect specifications from sempass2”
(<a href="https://github.com/nim-lang/Nim/issues/7216">#7216</a>)</li>
  <li>Fixed “C++: SIGABRT instead of IndexError for out-of-bounds”
(<a href="https://github.com/nim-lang/Nim/issues/6512">#6512</a>)</li>
  <li>Fixed “An uncaught exception in cpp mode doesn’t show the exception name/msg”
(<a href="https://github.com/nim-lang/Nim/issues/6431">#6431</a>)</li>
</ul>

        </div>
      </div>
    </div>
    <footer>
  <section class="content">
    <div class="pure-g">
      <div class="copyright pure-u-2-3">
        <p>
          除非另有说明，本页内容遵从
          <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0</a>
          许可。
          网站显示的代码遵从MIT许可。
        </p>
        <p>
          本网站在
          <a href="https://github.com/nim-lang-cn/website">GitHub</a>
          上可用并且欢迎提供贡献。
          官方网站由
          <a href="https://github.com/dom96">Dominik Picheta</a>和
          <a href="https://github.com/Calinou">Hugo Locurcio</a>设计。
          Logo由<a href="https://github.com/josephwecker">Joseph Wecker</a>设计。
        </p>
        <p>
          中文翻译由Nim中文社区提供。
          服务器和域名由<a href="https://blog.doylee.cn/">ch4o5</a>提供。
          <a href="https://github.com/gogolxdong">sheldon</a>提供了文档翻译和其他翻译支持。
        </p>
      </div>
      <div class="pure-u-1-3 right-center">
        <script data-cfbadgetype="a" data-cfbadgeskin="dkgray" type="text/javascript">
          //<![CDATA[
          try { window.CloudFlare || function () { var a = window.document, b = a.createElement("script"), a = a.getElementsByTagName("script")[0]; window.CloudFlare = []; b.type = "text/javascript"; b.async = !0; b.src = "//ajax.cloudflare.com/cdn-cgi/nexp/cloudflare.js"; a.parentNode.insertBefore(b, a) }(), CloudFlare.push(function (a) { a(["cloudflare/badge"]) }) } catch (e$$5) { try { console.error("CloudFlare badge code could not be loaded. " + e$$5.message) } catch (e$$6) { } };
          //]]>
        </script>
      </div>
    </div>
  </section>

</footer>
<script>
  (function () {
    function setTracking(a) {
      var url = a.href;
      a.onclick = function () {
        if (typeof (ga) !== "undefined") {
          ga('send', 'event', 'outbound', 'click', url, {
            'transport': 'beacon',
            'hitCallback': function () { document.location = url; }
          });
        }
      };
    }

    var a = document.getElementsByTagName("a");
    for (var i = 0; i < a.length; ++i) {
      if (a[i].hostname != location.hostname &&
        a[i].getAttribute("target") !== "_blank"
      ) {
        setTracking(a[i])
      }
    }
  })();
</script>
<script>
  $(function () {
    $("section a").attr("target", "_blank");
  });
</script>
<script>
  // 百度统计
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?c81f717a4630758267f3b86f9efa48f0";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  
  </body>
</html>
